---
id: 851f0575-80cd-47ed-873f-368eb8c4bd90
subject: >-
  Architecture change: Migrate memory storage from individual markdown files to
  JSONL format
keywords:
  - storage format
  - jsonl
  - migration
  - memory architecture
  - episodic
  - thinking
applies_to: global
occurred_at: '2025-12-21T17:34:47.718Z'
content_hash: 293c60546c8c91af
---
The project is undergoing a significant architectural change to move from individual markdown files in `local-recall/episodic-memory/` and `local-recall/thinking-memory/` directories to a JSONL (JSON Lines) format.

## New Storage Format

Two JSONL files in the root `local-recall/` folder:
- `episodic-memories.jsonl` - for episodic memories
- `thinking-memories.jsonl` - for thinking memories

Each line is a JSON object with:
- `type` - "add" or "delete"
- `memory` - the memory object (id, subject, keywords, applies_to, occurred_at, content_hash, content)
- `embeddings` - vector embeddings for the memory

## Migration Strategy

A migration check must be implemented to:
1. Load all existing memories from individual markdown files
2. Write them to the corresponding JSONL file with "add" type entries
3. Delete the old `episodic-memory/` and `thinking-memory/` directories
4. Run on startup if the old directories exist but new JSONL files don't

## Components to Update

This affects:
- Memory CRUD operations (src/core/memory.ts)
- Vector store implementation (src/core/vector-store.ts)
- Thinking memory operations (src/core/thinking-memory.ts)
- MCP server tools and daemon
- Hooks that read/write memories
- All tests that work with memory files
