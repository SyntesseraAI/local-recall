---
id: 93637dce-c454-4f7e-b1ee-bd5e72d206d4
subject: >-
  Memory extraction from transcripts should use claude -p to analyze content
  intelligently
keywords:
  - memory-extraction
  - transcript-analysis
  - claude-api
  - mcp-server
  - background-daemon
  - ai-analysis
applies_to: 'area:memory-extraction'
occurred_at: '2025-12-01T16:07:12.114Z'
content_hash: d839ff8ef10b3c2a
---
# Intelligent Memory Extraction via Claude

The MCP server uses `claude -p` (Claude's preview/piped input mode) to intelligently analyze transcript content and extract valuable memories.

## Implementation Pattern

Instead of using regex or simple pattern matching:
1. Read and parse transcript file
2. Format transcript data as readable text/markdown
3. Pipe content to `claude -p` with a structured prompt requesting memory extraction
4. Parse Claude's response to create memory objects
5. Store memories using the memory manager

## Benefits

- Claude can understand context and semantic meaning
- Can identify important architectural decisions, bugs fixed, patterns discovered
- Can write meaningful memory subjects and keywords
- Produces higher-quality memories than simple parsing
- Captures nuance and relationships between concepts

## MCP Server Integration

The background daemon (runs every 5 minutes):
1. Syncs new/modified transcripts from `~/.claude/projects/*/transcripts/`
2. Uses content hashing to detect changed transcripts
3. For new/changed transcripts: pipes to `claude -p` for memory extraction
4. Creates or updates corresponding memory files
5. Tracks processed transcripts to avoid re-processing

## Important Considerations

- Use consistent prompt format for Claude to understand what memories to extract
- Handle both successful extractions and cases where no valuable memories exist
- Clean up previous memories when transcripts change (delete and recreate)
- Set appropriate timeout for `claude -p` command execution
