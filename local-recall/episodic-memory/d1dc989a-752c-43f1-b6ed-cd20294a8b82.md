---
id: d1dc989a-752c-43f1-b6ed-cd20294a8b82
subject: >-
  Memory deduplication uses occurred_at timestamp and content_hash, no full
  compaction exists
keywords:
  - deduplication
  - memory-management
  - duplicate-prevention
  - compaction
  - memory.ts
  - findDuplicate
applies_to: 'file:src/core/memory.ts'
occurred_at: '2025-12-21T19:17:14.934Z'
content_hash: b5993b32570efbbc
---
Memory deduplication in Local Recall uses a **findDuplicate** method that checks for existing memories with matching `occurred_at` timestamp AND `content_hash` before creation.

Key findings:
- **No full memory compaction** - Memories are not automatically merged, consolidated, or pruned
- **Duplicate prevention only** - If a memory with the same timestamp and content hash exists, the existing memory is returned instead of creating a duplicate
- **Configuration exists** - `maxMemories` config option is defined in `src/utils/config.ts` (default 1000) but appears to not be actively used for pruning
- **Idempotent creation** - Memory creation is designed to be idempotent - creating the same memory multiple times returns the existing one

This means over time, the memory store can grow unbounded if `maxMemories` limit is not actively enforced.
