---
id: 8603925b-49c1-4426-a2b6-7c0148d13871
subject: Memory lifecycle and deduplication logic in local-recall
keywords:
  - memory
  - lifecycle
  - deduplication
  - content-hash
  - duplicate-detection
  - idempotent
applies_to: 'area:memory'
occurred_at: '2025-12-02T02:18:43.661Z'
content_hash: 2f2da14442ccc9f5
---
# Memory Lifecycle and Deduplication

## How Memory Deduplication Works

Local-recall implements idempotent memory creation through:

1. **Content Hash**
   - Each memory includes a `content_hash` field (SHA-256 prefix, 16 chars)
   - Calculated from the memory content to detect duplicates

2. **Occurred At Timestamp**
   - Each memory has an `occurred_at` field (ISO-8601 timestamp)
   - Used alongside content hash for deduplication

3. **Duplicate Detection**
   - `findDuplicate(occurredAt, contentHash)` function in memory.ts
   - Checks if a memory with matching timestamp and hash already exists
   - Returns existing memory if duplicate found (idempotent behavior)

## Memory CRD Operations

Local-recall implements CRD (Create, Read, Delete) operations:
- `createMemory(data)` - Creates new memory or returns existing duplicate
- `getMemory(id)` - Retrieve specific memory
- `listMemories(filter?)` - List all memories with optional filtering
- `deleteMemory(id)` - Remove a memory
- **No update operation** - Memories are immutable (idempotent design)

## Why No Update

Memories don't have update operations because they represent point-in-time information. If a memory needs to be changed, the old one should be deleted and a new one created with updated content.
