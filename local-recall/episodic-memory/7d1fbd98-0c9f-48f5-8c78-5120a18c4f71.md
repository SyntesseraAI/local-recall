---
id: 7d1fbd98-0c9f-48f5-8c78-5120a18c4f71
subject: 'Mutex errors in local-recall are from ONNX runtime (fastembed), not sqlite-vec'
keywords:
  - mutex
  - onnx
  - fastembed
  - concurrency
  - embedding
  - error
applies_to: global
occurred_at: '2025-12-03T11:24:27.209Z'
content_hash: e228384adba1662b
---
After migrating from SQLite with sqlite-vec to Orama for vector search, mutex errors persisted when running multiple concurrent hook processes. Investigation revealed the mutex errors originate from ONNX runtime used by fastembed embedding library, not from sqlite-vec. The proper-lockfile mechanism doesn't prevent ONNX's internal mutex issues when multiple processes attempt to load the embedding model concurrently. This is triggered when user-prompt-submit.ts directly instantiates SearchEngine/ThinkingSearchEngine, which load the embedding model without coordination between processes.
