---
id: c3994f07-f7ea-4772-a88e-479940a41c3f
subject: Transcript parser must be backward compatible with legacy format
keywords:
  - transcript parsing
  - backward compatibility
  - message format
  - graceful degradation
applies_to: 'file:src/utils/transcript.ts'
occurred_at: '2025-12-02T21:37:14.576Z'
content_hash: 00af2f89ef53073c
---
The transcript parser was updated to support both new and old message formats. When parsing messages:

1. First try to extract thinking from content blocks (`type: "thinking"`)
2. Fall back to root-level `thinking` field for legacy format
3. Extract text from either content blocks or root `text` field
4. Silently skip messages with invalid roles rather than throwing errors

This allows the system to work with both real Claude Code transcripts and test fixtures without breaking existing functionality.
