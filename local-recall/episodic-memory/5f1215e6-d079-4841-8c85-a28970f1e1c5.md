---
id: 5f1215e6-d079-4841-8c85-a28970f1e1c5
subject: >-
  Stop hook implementation uses transcript analysis with claude -p for memory
  extraction
keywords:
  - stop hook
  - transcript
  - memory extraction
  - claude -p
applies_to: 'file:src/hooks/stop.ts'
occurred_at: '2025-12-01T22:45:21.184Z'
content_hash: 246a987fefc2d073
---
Stop hook implementation:
- Located in `src/hooks/stop.ts` (193 lines)
- Uses `analyzeForMemories()` function from `src/utils/transcript.ts`
- Calls `claude -p` (model haiku) to extract keywords from transcript
- Processes transcripts asynchronously
- Tracks processed transcripts with content hashes for change detection
- Deletes and recreates memories when transcripts change
- MCP server daemon runs this every 5 minutes
- Currently disabled in favor of async background daemon processing
