---
id: 72d3911f-e6d0-42f2-94b2-e9c951ff91cb
subject: Local Recall memory model changed from mutable to immutable episodic log
keywords:
  - memory-design
  - idempotency
  - episodic
  - deduplication
  - architecture-decision
applies_to: global
occurred_at: '2025-12-21T18:20:31.269Z'
content_hash: 2cf9508d6bd71e13
---
## Key Decision: Immutable Episodic Memory Model

Changed from a mutable knowledge base (where memories could be updated/deleted) to an immutable episodic memory log.

### Rationale
- Memories are now permanent records tied to specific moments in time
- They can only be removed manually by the user
- This models how human memory actually works - episodic logs of events

### Deduplication Strategy
Memories are deduplicated using a composite key:
- **`occurred_at`** - ISO-8601 timestamp from the transcript (when the conversation happened)
- **`content_hash`** - SHA-256 hash of content, truncated to 16 chars (for exact content matching)

Before creating a memory, check if one exists with the same `occurred_at` + `content_hash`. If yes, skip creation (idempotent).

### Implementation Details
- Removed `updated_at` field (memories don't change)
- Removed `updateMemory()` and `deleteMemory()` methods from MCP tools
- Added `computeContentHash()` using SHA-256
- Added `findDuplicate(occurredAt, contentHash)` method for dedup checks
- Stop hook now processes entire transcript history (not just 30-second window)
- Added `created_at` field to track when the memory file was written
