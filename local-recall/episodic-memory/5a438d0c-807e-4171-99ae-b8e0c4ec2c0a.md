---
id: 5a438d0c-807e-4171-99ae-b8e0c4ec2c0a
subject: User prompt submit hook unifies episodic and thinking memory searches
keywords:
  - user-prompt-submit
  - semantic-search
  - episodic-memory
  - thinking-memory
  - unified-search
  - configuration
applies_to: 'file:src/hooks/user-prompt-submit.ts'
occurred_at: '2025-12-21T18:23:39.604Z'
content_hash: 84b2bb62e12a238b
---
The UserPromptSubmit hook performs unified semantic search across both episodic and thinking memory types. It respects independent configuration for each memory type (max tokens and minimum similarity threshold). Results from both stores are combined, deduplicated by ID, and ranked by similarity score. The hook skips internal prompts (marked with `[LOCAL_RECALL_INTERNAL]`) to avoid processing metadata queries.
