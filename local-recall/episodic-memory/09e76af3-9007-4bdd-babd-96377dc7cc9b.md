---
id: 09e76af3-9007-4bdd-babd-96377dc7cc9b
subject: >-
  Memories are idempotent - createMemory returns existing memory if duplicate
  detected
keywords:
  - idempotent
  - create-memory
  - duplicate-detection
  - content-hash
  - design-pattern
applies_to: 'file:src/core/memory.ts'
occurred_at: '2025-12-02T06:30:32.846Z'
content_hash: e8c8497259a9043e
---
The createMemory function is idempotent: if a memory with the same occurred_at timestamp and content_hash already exists, it returns the existing memory instead of creating a duplicate. This allows safe re-execution of memory creation logic without manual deduplication checks by callers. The function logs a message indicating whether a memory was created or returned from an existing duplicate.
