---
id: ae292fa4-b534-4c33-bb33-b17020f91e18
subject: Memory extractor successfully works with Haiku model
keywords:
  - memory-extractor
  - haiku
  - model-switching
  - cost-optimization
  - performance
applies_to: 'file:src/core/memory-extractor.ts'
occurred_at: '2025-12-21T18:15:07.227Z'
content_hash: cfc0dc836ce01642
---
# Memory Extractor Model Optimization

Tested and validated that Claude Haiku can successfully handle the memory extraction task from transcripts. Haiku correctly extracts structured memories with valid markdown formatting that the existing `stripMarkdownCodeBlocks` method already handles.

## Performance and Cost Benefits

- Haiku is approximately **20x cheaper** than Sonnet for this task
- Haiku is significantly **faster** than Sonnet
- The structured extraction task (parsing transcripts into JSON memories) is well-suited to Haiku's capabilities
- Memory extraction is a high-volume workload (daemon processes transcripts every 5 minutes), making cost savings substantial

## Implementation

Updated `callClaudeCLI` method in `src/core/memory-extractor.ts` (lines 80-81) to add `--model haiku` flag to Claude CLI invocation. All 32 unit tests pass with this change.

## Testing

Verified with integration test that Haiku correctly:
1. Extracts valid memories from transcript samples
2. Returns properly formatted JSON with code blocks
3. Handles the full memory extraction pipeline
