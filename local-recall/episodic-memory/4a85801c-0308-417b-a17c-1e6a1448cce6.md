---
id: 4a85801c-0308-417b-a17c-1e6a1448cce6
subject: Memory extraction field name normalization handles Claude model variations
keywords:
  - memory-extractor
  - field-normalization
  - zod-validation
  - claude-haiku
  - error-handling
applies_to: 'file:src/core/memory-extractor.ts'
occurred_at: '2025-12-21T18:21:17.810Z'
content_hash: 0af0316f4d9b2823
---
Claude Haiku sometimes returns memory objects with alternative field names instead of the expected `subject`, `keywords`, `applies_to`, and `content` fields. Added field name normalization in parseClaudeResponse (lines 179-186) that maps common variations:

- `subject` ← `summary` | `title` | `subject`
- `keywords` ← `tags` | `keywords`
- `applies_to` ← `scope` | `applies_to`
- `content` ← `description` | `body` | `content`

This normalization is applied to each memory object before Zod validation, preventing validation failures when Claude uses slightly different field names. The fix handles both direct array responses and wrapped responses (e.g., `{memories: [...]}`)
