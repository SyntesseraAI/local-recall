---
id: 065e398f-696d-4392-9fed-3758d2e995d2
subject: Memory lifecycle and session flow patterns
keywords:
  - memory
  - lifecycle
  - session
  - hooks
  - transcript
  - extraction
  - indexing
applies_to: global
occurred_at: '2025-12-01T23:01:35.684Z'
content_hash: ca3af09043f31e40
---
# Memory Lifecycle and Session Flow

## Complete Memory Flow

1. **Session Start**
   - Hook triggered: Load memory index from `local-recall/index.json`
   - Retrieve relevant memories based on context
   - Inject memories into Claude's context

2. **User Prompt Submit**
   - Hook triggered: Extract keywords from user prompt
   - Search memory index for matching keywords
   - Inject matching memories into context

3. **Session End (Stop Hook)**
   - Transcript is collected from Claude's cache
   - Transcript is condensed to manageable size
   - Memories are extracted from condensed transcript
   - Index is rebuilt to include new memories

## Key Integration Points

- Hooks in `src/hooks/` directory
- Memory operations in `src/core/memory.ts`
- Index management in `src/core/index.ts`
- Search in `src/core/search.ts`
- Extraction in `src/core/memory-extractor.ts`

## Index Cache

- Index stored at `local-recall/index.json`
- Gitignored to avoid constant changes
- Rebuilt on memory creation and session end
- Used for fast keyword lookup
