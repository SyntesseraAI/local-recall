---
id: 619e7700-468f-435f-bee4-cb4716322ff5
subject: 'Memory extraction is triggered by transcript processing, not session stop hook'
keywords:
  - memory-extraction
  - transcript-processing
  - mcp-server
  - daemon
  - async
  - disabled-hook
applies_to: global
occurred_at: '2025-12-02T16:52:24.705Z'
content_hash: 14799e12b2d4e246
---
# Memory Extraction Architecture

The Stop hook is disabled in the current codebase. Instead, memory extraction is handled asynchronously:

## Current Implementation

1. **MCP Server Daemon**: Runs continuously in the background
2. **Polling Interval**: Processes transcripts every 5 minutes
3. **Async Processing**: Uses `claude -p` command to extract memories from transcripts
4. **Change Detection**: Tracks processed transcripts with content hashes to identify changes
5. **Idempotency**: Deletes and recreates memories when transcripts change

## Why This Approach

- The Stop hook approach was problematic for memory extraction
- Background daemon allows asynchronous processing without blocking the session
- More reliable and consistent than hook-based extraction
- Allows for better error handling and retry logic

## Configuration

The daemon behavior is configured in the MCP server setup and does not require stop hook configuration.
