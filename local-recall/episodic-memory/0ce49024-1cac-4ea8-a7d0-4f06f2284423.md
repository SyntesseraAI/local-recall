---
id: 0ce49024-1cac-4ea8-a7d0-4f06f2284423
subject: >-
  Transcript collector needs robust path handling and URL decoding for project
  directories
keywords:
  - transcript-collector
  - path-encoding
  - url-decode
  - macos
  - file-operations
  - debugging
applies_to: 'file:src/core/transcript-collector.ts'
occurred_at: '2025-12-02T06:05:14.210Z'
content_hash: ec10652a2c70090d
---
# Transcript Collector Path Handling

## Path Encoding Issues

When working with Claude's transcript directories, the path must be properly encoded:

### Current Implementation

The `transcript-collector.ts` file constructs the transcript path by:
1. Taking the project working directory (e.g., `/Users/joe/Code/Syntessera/local-recall`)
2. Replacing `/` with `_` to create the folder name
3. Looking in `~/.claude/projects/<encoded-path>/transcripts/`

### Known Edge Cases

- Path encoding must handle special characters that may appear in file paths
- URL decoding considerations: paths may need `decodeURIComponent()` in some contexts
- The transcript path construction should be resilient to missing directories

## Debugging Tips

- Log the full constructed paths during development
- Test with paths containing special characters or spaces
- Verify the actual encoding Claude uses matches expectations
- The `cwd` passed to hooks is already the correct project directory

## Related Code

- `src/core/transcript-collector.ts` - Main implementation
- `src/hooks/stop.ts` - Calls transcript collector
- `src/mcp-server/server.ts` - Daemon process that also processes transcripts
