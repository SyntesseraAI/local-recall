---
id: bcc201cb-4d3a-4a0f-9b05-1df96cdff294
subject: MCP server transcript processing and daemon architecture pattern
keywords:
  - mcp-server
  - daemon
  - transcript-processing
  - memory-extraction
  - background-task
  - polling
applies_to: 'area:mcp-server'
occurred_at: '2025-12-01T15:55:58.628Z'
content_hash: c7f71b600d132330
---
# MCP Server Transcript Processing Pattern

The MCP server implements a background daemon that processes transcripts asynchronously:

## Architecture

1. **Async Processing**: The MCP server runs a background daemon that processes transcripts every 5 minutes rather than blocking on every call
2. **Polling Strategy**: Uses a polling mechanism to check for new/updated transcripts instead of real-time event hooks
3. **Deduplication**: Tracks processed transcripts using content hashes to avoid reprocessing

## Implementation Approach

- Daemon runs independently of request/response cycle
- Reads transcripts from Claude's cache directory
- Processes them with `claude -p` to extract memories
- Stores metadata about processed transcripts to detect changes
- If transcript content changes (different hash), deletes old memories and creates new ones

## Advantages

- Doesn't block MCP tool calls
- Handles transcript processing reliably
- Tolerates transcript changes gracefully
- Distributes load over time rather than spiking on session end
