---
id: 616797e2-48b0-4e11-86e4-1ee7e1344e9d
subject: >-
  User-prompt-submit hook calls Claude with spawn to extract keywords from
  prompts
keywords:
  - user-prompt-submit
  - keyword extraction
  - claude haiku
  - spawn
  - hook
applies_to: 'file:src/hooks/user-prompt-submit.ts'
occurred_at: '2025-12-01T16:27:26.632Z'
content_hash: 21385c5537e2b8d5
---
The user-prompt-submit hook uses the `callClaudeForKeywords` function to extract searchable keywords from user prompts. It spawns a child process running Claude (using `claude -p --model haiku`) to analyze the prompt text and return keywords. These keywords are then used to search the memory index for relevant memories to inject into Claude's context before processing the prompt.

Key implementation details:
- Uses promise-based wrapper around child process
- Parses JSON output from Claude for keyword extraction
- Handles both stdout and stderr properly
- Must handle process completion correctly to avoid race conditions
