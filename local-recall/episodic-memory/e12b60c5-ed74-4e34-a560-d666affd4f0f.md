---
id: e12b60c5-ed74-4e34-a560-d666affd4f0f
subject: Plugin cache MCP server must bundle dependencies for deployment
keywords:
  - plugin
  - mcp server
  - esbuild
  - bundling
  - dependencies
  - external
  - deployment
applies_to: global
occurred_at: '2025-12-12T10:14:38.028Z'
content_hash: aa1dc2f4898ea2f7
---
The plugin system deploys the MCP server to `~/.claude/plugins/cache/local-recall-marketplace/local-recall/0.1.0/scripts/mcp-server/server.js` without node_modules. The build script in package.json had `--external:@modelcontextprotocol/sdk` which prevented bundling the MCP SDK.

**Fix**: Remove the `--external` flag from the esbuild command in package.json so dependencies are bundled into server.js. This increases the server size from ~704KB to ~1.1MB but ensures it runs without external dependencies.

**Note**: After fixing the build, update the plugin cache by either copying the new server.js or reinstalling the plugin, then restart Claude Code instances.
