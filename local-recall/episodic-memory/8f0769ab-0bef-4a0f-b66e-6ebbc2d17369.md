---
id: 8f0769ab-0bef-4a0f-b66e-6ebbc2d17369
subject: Memory extraction happens in Stop hook via transcript parsing
keywords:
  - transcript parsing
  - memory extraction
  - stop hook
  - src/hooks/stop.ts
  - transcript schema
applies_to: 'file:src/hooks/stop.ts'
occurred_at: '2025-12-21T19:30:34.227Z'
content_hash: 680746576e61b0f6
---
The Stop hook (src/hooks/stop.ts:77-108) is responsible for extracting memories from sessions. It:
1. Receives the session transcript path from Claude Code
2. Parses the transcript JSON using transcript schema from src/utils/transcript.ts
3. Creates episodic and thinking memories using the memory manager
4. Filters out internal prompts and tool-only responses

The transcript structure includes tool invocations, user messages, and assistant responses that are analyzed to extract valuable memories.
