---
id: 5c821da0-6656-4322-9044-59e6121c506e
subject: Unified UserPromptSubmit hook handles both episodic and thinking memories
keywords:
  - hooks
  - user-prompt-submit
  - episodic
  - thinking
  - unified
  - architecture
applies_to: global
occurred_at: '2025-12-21T18:28:29.693Z'
content_hash: ec50fb86c48908dd
---
The UserPromptSubmit hook in src/hooks/user-prompt-submit.ts is now a unified hook that handles both episodic and thinking memory searches based on configuration. It:

1. Skips internal prompts containing [LOCAL_RECALL_INTERNAL]
2. Conditionally searches episodic memories if episodicEnabled
3. Conditionally searches thinking memories if thinkingEnabled
4. Filters results by similarity threshold and token budget
5. Combines results from both types before outputting

This replaces the older approach of having separate hooks for each memory type. The plugin configuration should point to this single unified hook, not to deleted specialized hooks.
