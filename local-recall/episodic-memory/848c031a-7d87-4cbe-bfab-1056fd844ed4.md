---
id: 848c031a-7d87-4cbe-bfab-1056fd844ed4
subject: How Claude Code memory extraction system works in Local Recall
keywords:
  - memory-extraction
  - transcript-processing
  - mcp-server
  - background-daemon
  - hook-disabled
applies_to: global
occurred_at: '2025-12-01T15:59:01.712Z'
content_hash: f32a6db98b80d7af
---
# Memory Extraction System

Local Recall extracts memories from Claude Code session transcripts using an MCP server background daemon.

## Current Implementation

The Stop hook is currently **disabled**. Instead:
- The MCP server runs a background daemon
- Every 5 minutes, it syncs transcripts from `~/.claude/projects/<project>/transcripts/`
- Processes transcripts using Claude Haiku (`claude -p --model haiku`)
- Extracts memory content and metadata
- Tracks processed transcripts with content hashes for change detection
- Deletes and recreates memories when transcripts change

## Transcript Condensing

Before memory extraction, transcripts are condensed into events:
- `[User]` - User requests/questions
- `[Assistant]` - Claude explanations/responses
- `[Tool: Name]` - Tool invocations
- `[Result: OK/ERROR]` - Tool outcomes

This condensing happens during the extraction process to reduce token usage when analyzing transcripts with Haiku.
