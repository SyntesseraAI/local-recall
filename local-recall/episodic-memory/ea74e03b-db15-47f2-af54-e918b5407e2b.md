---
id: ea74e03b-db15-47f2-af54-e918b5407e2b
subject: Vector store initialization is lazy-loaded in UserPromptSubmit hook
keywords:
  - vector-store
  - initialization
  - lazy-loading
  - performance
  - hook
  - user-prompt-submit
applies_to: 'file:src/hooks/user-prompt-submit.ts'
occurred_at: '2025-12-02T16:59:26.008Z'
content_hash: b7625eb4fdb3e4a8
---
# Lazy Vector Store Initialization

## Performance Optimization

The vector store is not initialized on every session start (unlike SessionStart hook which loads memories from disk).

Instead:
- The vector store is initialized lazily on first `UserPromptSubmit` hook call
- The store is cached after initialization to avoid reinitializing on subsequent prompts
- This avoids slow startup time if the embedding model hasn't been loaded yet

## Implementation

In `user-prompt-submit.ts`, the initialization happens:
1. First call checks if store is initialized
2. If not, calls `initialize()` which downloads/loads the embedding model
3. Subsequent calls reuse the cached store

This is different from the SessionStart hook which does a full file-based reload every time.
