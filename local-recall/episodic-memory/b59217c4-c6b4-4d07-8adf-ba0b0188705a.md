---
id: b59217c4-c6b4-4d07-8adf-ba0b0188705a
subject: Memory deduplication uses occurred_at timestamp and content_hash
keywords:
  - deduplication
  - memory-crud
  - content-hash
  - occurred-at
  - idempotent
applies_to: 'file:src/core/memory.ts'
occurred_at: '2025-12-01T22:42:26.009Z'
content_hash: 158ab30ca9c264e0
---
# Memory Deduplication Strategy

Memories are deduplicated using two fields:
1. **occurred_at**: ISO-8601 timestamp when the original event occurred
2. **content_hash**: SHA-256 prefix (16 characters) of the memory content

## Implementation

The `findDuplicate(occurredAt, contentHash)` function checks if a memory already exists before creation.

## Benefits

- **Idempotent operation**: Creating the same memory twice returns the existing one
- **Change detection**: If content changes, a new memory is created (different hash)
- **Timestamp ordering**: Results can be sorted chronologically by occurred_at
- **Prevents redundancy**: Avoids storing duplicate learnings
