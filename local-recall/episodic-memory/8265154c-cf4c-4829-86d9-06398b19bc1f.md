---
id: 8265154c-cf4c-4829-86d9-06398b19bc1f
subject: >-
  Memory deduplication uses occurred_at timestamp and content_hash to prevent
  duplicate entries
keywords:
  - deduplication
  - occurred_at
  - content_hash
  - memory-lifecycle
  - duplicate-prevention
  - idempotent
applies_to: global
occurred_at: '2025-12-02T01:53:18.922Z'
content_hash: fe6ad368a637aaaa
---
# Memory Deduplication Strategy

Memories are deduplicated using two fields:

1. **occurred_at**: ISO-8601 timestamp of when the original event occurred
2. **content_hash**: SHA-256 hash prefix (16 characters) of the memory content

The `findDuplicate()` function checks if a memory with the same `occurred_at` and `content_hash` already exists before creating a new memory.

## Why This Matters

When transcripts are re-processed (due to changes or re-runs), the same memory content might be extracted again. By using these two fields as a composite key, the system can:
- Detect when the same memory has already been created
- Avoid creating duplicate memories
- Return the existing memory ID instead of creating a new one

This makes the `createMemory()` operation idempotent - calling it multiple times with the same content will return the same memory ID.

## Implementation

See `src/core/memory.ts` - `findDuplicate()` function for the implementation.
