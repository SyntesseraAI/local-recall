---
id: c8194a0a-b3c8-462d-9b50-23941f0fa9aa
subject: Transcript processing workflow in stop hook
keywords:
  - stop hook
  - transcript processing
  - memory creation
  - deduplication
  - occurred_at
applies_to: 'file:src/hooks/stop.ts'
occurred_at: '2025-12-01T15:52:53.508Z'
content_hash: ea2a50c8e5c8723c
---
The stop hook workflow:

1. Reads the transcript file
2. Parses all messages using `parseTranscript()`
3. Calls `analyzeForMemories()` to filter messages (only multi-line assistant responses)
4. For each qualifying message, creates a memory with:
   - Subject extracted from content preview
   - Keywords generated using keyword-extractor library
   - Content set to the full message text
   - Timestamp (occurred_at) set to the message timestamp
   - Content hash for deduplication
5. Uses `findDuplicate()` to check for existing memories before creating new ones
