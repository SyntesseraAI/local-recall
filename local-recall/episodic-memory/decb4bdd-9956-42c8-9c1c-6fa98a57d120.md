---
id: decb4bdd-9956-42c8-9c1c-6fa98a57d120
subject: >-
  Architecture pattern for transcript processing: raw content → parser → memory
  suggestions
keywords:
  - architecture pattern
  - transcript processing
  - parser design
  - separation of concerns
applies_to: global
occurred_at: '2025-12-01T23:16:45.613Z'
content_hash: c7a6696de98dea47
---
Established pattern for transcript processing in local-recall:

1. **Raw content layer** - parseTranscriptForMemories() takes raw JSONL string from transcript file
2. **Parser layer** - Converts raw JSONL entries into normalized TranscriptMessage objects, extracting thinking and content blocks
3. **Analysis layer** - analyzeForMemories() analyzes messages and generates memory suggestions
4. **Storage layer** - Caller (e.g., stop.ts) saves the memory suggestions using MemoryManager

This separation allows the same parsing logic to be reused in different contexts (stop hook, MCP server, other tools) without duplication. The parseTranscriptForMemories() function is the public API that other code should use.
