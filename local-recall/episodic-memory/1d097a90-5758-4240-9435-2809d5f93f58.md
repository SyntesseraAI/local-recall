---
id: 1d097a90-5758-4240-9435-2809d5f93f58
subject: Filter transcripts to only copy those containing thinking blocks
keywords:
  - transcript-collector
  - thinking
  - haiku
  - filtering
  - sync
  - transcript-sync
applies_to: 'file:src/core/transcript-collector.ts'
occurred_at: '2025-12-03T09:47:11.434Z'
content_hash: c413c4f8384f46b2
---
## Problem
The transcript collector was copying all transcripts including Haiku transcripts (which don't contain thinking blocks). This was cluttering the transcript cache with transcripts that don't contribute to thinking memory extraction.

## Solution
Added filtering logic to the TranscriptCollector:

1. **New method `hasThinkingBlocks()`** - Checks if a transcript contains thinking blocks by searching for `"type":"thinking"` in the JSON content. Returns boolean.

2. **Updated `syncTranscripts()`** - Modified to skip copying transcripts that don't contain thinking blocks, logging debug info when skipping.

3. **Updated `cleanupTranscripts()`** - Removes existing transcripts that don't contain thinking blocks from the transcript cache.

## Implementation Details
- The thinking check looks for content blocks with `type: "thinking"` in the transcript JSON structure
- Both sync and cleanup methods use the same `hasThinkingBlocks()` check for consistency
- This prevents Haiku-only transcripts (which have no thinking capability) from being copied or retained

## Impact
- Reduces transcript cache size by excluding haiku transcripts
- Improves efficiency of thinking memory extraction by only processing relevant transcripts
- Maintains cleaner transcript history focused on thinking-capable models
