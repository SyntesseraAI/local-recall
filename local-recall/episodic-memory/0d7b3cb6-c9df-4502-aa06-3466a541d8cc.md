---
id: 0d7b3cb6-c9df-4502-aa06-3466a541d8cc
subject: >-
  Stop hook changed to process entire transcript history instead of recent
  messages
keywords:
  - stop-hook
  - transcript
  - processing
  - transcript-parsing
applies_to: 'file:src/hooks/stop.ts'
occurred_at: '2025-12-21T19:17:28.905Z'
content_hash: b6292a1d27602ef3
---
# Stop Hook Processing Logic Update

## Previous Behavior
Processed only messages within a 30-second time window from the moment the hook fires. This caused the hook to often output "No recent messages to analyze" because messages aged out of the window.

## New Behavior
Processes the entire transcript history. Deduplication via `occurred_at + content_hash` prevents duplicate memories from being created when the same transcript is processed multiple times.

## Implementation
- Removed the 30-second time window check
- Now extracts all transcript messages regardless of age
- Relies on idempotency mechanism to handle re-processing
