---
id: 326a13ed-0d9f-4ac7-bf81-869f0d24975d
subject: 'Plugin cache MCP server needs bundled dependencies, not external imports'
keywords:
  - plugin cache
  - bundling
  - esbuild
  - external dependencies
  - mcp sdk
  - deployment
applies_to: 'file:package.json'
occurred_at: '2025-12-21T18:31:23.288Z'
content_hash: 9277338141d27f33
---
The plugin deployment system caches MCP servers at `~/.claude/plugins/cache/` without including `node_modules`. The build script was using `--external:@modelcontextprotocol/sdk` which prevented bundling the MCP SDK into the server.js file.

Fix: Remove `--external:@modelcontextprotocol/sdk` from the esbuild configuration so that dependencies are bundled into a self-contained server.js (~1.1MB instead of 704KB).

This applies to the build script for dev-marketplace plugin deployment.
