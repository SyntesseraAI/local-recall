---
id: 15587345-df6b-445f-a3ea-7514c832550e
subject: Plugin hooks migration from better-sqlite3 to Orama
keywords:
  - plugin
  - hooks
  - better-sqlite3
  - orama
  - migration
  - stale-code
  - user-prompt-submit
applies_to: 'area:plugin-hooks'
occurred_at: '2025-12-21T18:27:24.119Z'
content_hash: 5ea625dd10e6b7a3
---
The local-recall-plugin had stale hook files that tried to import `better-sqlite3` (a native module that cannot be bundled). The main project switched to Orama (pure JavaScript) for vector search, but the plugin still had old bundled hooks pointing to `user-prompt-submit-thinking.js` which attempted to use better-sqlite3.

**Solution**: Removed the stale `user-prompt-submit-thinking.js` file and updated `dev-marketplace/local-recall-plugin/config/hooks.json` to use the unified `user-prompt-submit.js` hook instead. This hook now handles both episodic and thinking memories using Orama.

**Why this matters**: Native module dependencies cannot be bundled into hook scripts that execute as CLI commands. Orama's pure JavaScript implementation is the correct choice for plugin hooks.
