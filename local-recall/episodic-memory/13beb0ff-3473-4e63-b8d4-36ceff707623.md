---
id: 13beb0ff-3473-4e63-b8d4-36ceff707623
subject: >-
  Thinking extractor now groups JSONL entries by message.id to capture complete
  messages
keywords:
  - message grouping
  - jsonl
  - thinking extractor
  - parsing
  - transcript processing
applies_to: 'file:src/core/thinking-extractor.ts'
occurred_at: '2025-12-03T09:47:36.366Z'
content_hash: b74947416a68924f
---
The `parseTranscriptForThinking` function was rewritten to properly handle Claude Code's JSONL format where each content block is a separate line. Key changes:

1. Iterate through all JSONL lines and group by `message.id`
2. For each message group, collect all `content` entries
3. Extract thinking blocks where `type === 'thinking'`
4. Extract corresponding text output where `type === 'text'`
5. Skip tool-only responses (where no text output follows thinking)
6. Create thinking memory pairs from thought+output combos

This ensures complete thinking chains are captured instead of fragmentary single-line extractions.
