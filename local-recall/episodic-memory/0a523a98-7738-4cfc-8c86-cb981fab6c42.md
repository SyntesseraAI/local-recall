---
id: 0a523a98-7738-4cfc-8c86-cb981fab6c42
subject: >-
  MCP server daemon processes transcripts asynchronously every 5 minutes for
  memory extraction
keywords:
  - mcp-server
  - background-daemon
  - transcript-processing
  - memory-extraction
  - async
applies_to: 'file:src/mcp-server/server.ts'
occurred_at: '2025-12-01T21:58:07.918Z'
content_hash: 6e989828f29cf564
---
The MCP server implements a background daemon that automatically extracts memories from session transcripts without blocking the user:

1. Daemon wakes every 5 minutes to check for new transcripts
2. Reads transcript from Claude's cache directory (`~/.claude/projects/<project>/transcripts/`)
3. Condenses the transcript to reduce token usage (60-70% reduction)
4. Sends condensed transcript to Claude Haiku for memory extraction
5. Tracks processed transcripts using content hashes to detect changes
6. Creates/updates/deletes memories based on extracted data
7. Handles errors gracefully without disrupting the AI session

This design ensures memories are continuously enriched without manual intervention or user-facing delays. The Stop hook is disabled in favor of this async daemon for better performance.
