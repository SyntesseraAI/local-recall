---
id: 52c5e518-9e59-406c-b348-97a749905f6d
subject: >-
  UserPromptSubmit hook filters internal memories using [LOCAL_RECALL_INTERNAL]
  marker
keywords:
  - hooks
  - user prompt submit
  - internal prompts
  - memory extraction
  - filtering
  - claude prompts
applies_to: 'file:src/hooks/user-prompt-submit.ts'
occurred_at: '2025-12-21T18:59:50.981Z'
content_hash: dd547e0173cfe484
---
The UserPromptSubmit hook implementation skips processing internal prompts that contain the `[LOCAL_RECALL_INTERNAL]` marker. This is important for:

1. **Preventing noise** - Memory extraction prompts sent internally to Claude should not create additional memories
2. **Clean audit trail** - Only user-initiated prompts contribute to the memory system
3. **Avoiding circular memory creation** - If memory extraction itself created memories about memory extraction, it would cause feedback loops

When sending internal prompts for memory extraction, always include the `[LOCAL_RECALL_INTERNAL]` marker to prevent the UserPromptSubmit hook from processing them as user memories.
