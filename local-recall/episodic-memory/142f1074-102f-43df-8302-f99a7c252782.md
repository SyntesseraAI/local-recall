---
id: 142f1074-102f-43df-8302-f99a7c252782
subject: Memory deduplication and idempotency patterns
keywords:
  - deduplication
  - idempotency
  - content-hash
  - occurred-at
applies_to: 'file:src/core/memory.ts'
occurred_at: '2025-12-02T11:57:20.944Z'
content_hash: 62acc63fdbb3a790
---
# Memory Deduplication

## Duplicate Detection
Memories are deduplicated using `findDuplicate(occurredAt, contentHash)` which checks:
- `occurred_at`: When the original event occurred (for temporal matching)
- `content_hash`: SHA-256 prefix of content (for change detection)

## Idempotency
- `createMemory()` returns existing memory if duplicate detected
- No update operation exists - memories are immutable after creation
- This ensures consistent memory state across multiple agents

## CRD Operations
Memory manager implements Create, Read, Delete operations only:
- `createMemory(data)` - Create new or return existing if duplicate
- `getMemory(id)` - Retrieve specific memory
- `deleteMemory(id)` - Remove memory by ID
- `listMemories(filter?)` - List all with optional filtering
