---
id: 0d3cbc3e-1039-4b32-8b0a-57055824cf9c
subject: Use git filter-branch to remove files from unpushed commits
keywords:
  - git
  - filter-branch
  - history rewrite
  - index-filter
  - force-with-lease
applies_to: global
occurred_at: '2025-12-21T19:12:57.471Z'
content_hash: 5cf662bf87f075c7
---
When files are accidentally committed but not yet pushed, use `git filter-branch --force --index-filter 'git rm --cached --force -- <file>'` to rewrite history. Set `FILTER_BRANCH_SQUELCH_WARNING=1` to suppress warnings. After rewriting, clean up filter-branch backup refs with `git update-ref -d refs/original/refs/heads/main`. Use `git push --force-with-lease` (safer than `--force`) when pushing rewritten commits to ensure no concurrent pushes are overwritten.
