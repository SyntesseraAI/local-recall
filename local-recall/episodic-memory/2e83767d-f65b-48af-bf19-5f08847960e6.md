---
id: 2e83767d-f65b-48af-bf19-5f08847960e6
subject: >-
  Memory extraction workflow - MCP server processes transcripts asynchronously
  every 5 minutes
keywords:
  - memory-extraction
  - mcp-server
  - background-daemon
  - transcript-processing
  - workflow
  - async
  - polling
applies_to: global
occurred_at: '2025-12-02T01:08:26.039Z'
content_hash: 4a7238b03cf4a7cc
---
# Memory Extraction Workflow

The Local Recall system uses a background daemon (MCP server) to process transcripts and extract memories asynchronously.

## Current Architecture

1. **Stop Hook**: Currently disabled (not running)
2. **MCP Server Daemon**: Runs in the background
   - Syncs transcripts from `~/.claude/projects/<project>/transcripts/`
   - Processes transcripts using Claude Haiku to extract memories
   - Tracks processed transcripts with content hashes for change detection
   - Deletes and recreates memories when transcripts change
   - Runs every 5 minutes

## Transcript Processing

The system:
- Reads JSONL transcript files from Claude's cache
- Uses content hashing to detect changes
- Calls `claude -p` with Haiku model to extract memories
- Creates memory files from extracted memories
- Maintains a record of processed transcripts

## Key Components

- `src/mcp-server/server.ts` - Main MCP server implementation
- `src/core/transcript-collector.ts` - Reads and processes transcripts
- Memory extraction logic uses Claude Haiku model
