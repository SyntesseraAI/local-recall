---
id: d19a0ac4-392b-4091-b326-36b47ccb6cc6
subject: UserPromptSubmit hook uses lazy-initialized vector store for semantic search
keywords:
  - userpromptsubmit-hook
  - semantic-search
  - lazy-initialization
  - vector-embeddings
applies_to: 'file:src/hooks/user-prompt-submit.ts'
occurred_at: '2025-12-02T11:45:36.373Z'
content_hash: c1602a2969ab806b
---
The UserPromptSubmit hook performs semantic search on user prompts:
1. Receives JSON with session_id, transcript_path, cwd, prompt
2. Lazily initializes vector store on first use (cached after initialization)
3. Performs semantic similarity search using embeddings
4. Outputs matching memories to stdout

This approach balances performance (lazy init) with functionality (semantic search on every prompt).
