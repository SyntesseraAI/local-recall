---
id: 8478c576-b685-435e-a1bd-7fe5cc5dcb80
subject: Transcript collection and deduplication strategy
keywords:
  - transcript
  - deduplication
  - content-hash
  - sync
  - memory-extraction
  - transcript-collector
applies_to: 'area:transcript-collector'
occurred_at: '2025-12-02T02:04:08.305Z'
content_hash: 23bf9a9583834e68
---
# Transcript Collection and Deduplication

The `transcript-collector.ts` module handles syncing transcripts from Claude's cache and deduplicating them to avoid reprocessing.

## Deduplication Mechanism

Transcripts are deduplicated using SHA-256 content hashes stored in `transcripts.json`:
- File: `local-recall/transcripts.json`
- Structure: Object mapping transcript filenames to their content hashes
- Purpose: Track which transcripts have already been processed

## Processing Flow

1. Scan `~/.claude/projects/<project-name>/transcripts/` for JSONL files
2. For each transcript file:
   - Calculate SHA-256 hash of the file content
   - Check if hash exists in `transcripts.json`
   - If new or changed (hash differs):
     - Read and parse the JSONL content
     - Extract events for memory creation
     - Store hash in `transcripts.json`
   - If unchanged (same hash):
     - Skip processing

## Change Detection

If a transcript's hash changes (file was rewritten):
- Delete all memories associated with that transcript
- Reprocess the transcript
- Store the new hash

This ensures memories stay in sync with transcript updates while avoiding duplicate processing of unchanged files.
