---
id: 23e1aec3-5f0f-40dc-9312-bb5386ccf1c8
subject: Memory extraction uses claude -p to process transcript content
keywords:
  - memory
  - extraction
  - claude
  - process
  - transcript
  - haiku
  - stdin
  - prompt
  - structured
applies_to: 'area:memory-extraction'
occurred_at: '2025-12-02T07:40:20.871Z'
content_hash: 781a770dd73daa1e
---
# Memory Extraction Process

Memory extraction from transcripts is performed using the `claude -p` command-line tool.

## Implementation Details

### Subprocess Invocation

The extraction process:
1. Reads transcript JSONL content
2. Pipes transcript data to `claude -p` via stdin
3. Provides a structured prompt asking Claude to extract memories
4. Claude (Haiku model) processes the transcript and outputs memory suggestions
5. Parsed output is converted to memory file objects

### Prompt Structure

The prompt sent to `claude -p` should request:
- Memories worth retaining from the session (architectural decisions, bugs fixed, etc.)
- Proper YAML frontmatter format for memory files
- Focused keywords for future searchability
- Appropriate scope determination (global vs file-specific vs area-specific)

## Transcript Content Handling

Transcripts are processed as JSONL format where:
- Each line is a separate JSON object representing an event
- Events include user messages, assistant responses, tool invocations
- Tool invocation results are included in the transcript
- The full conversation context is preserved for analysis

## Location

Implementation: `src/core/memory-extractor.ts` and used by the MCP server daemon
