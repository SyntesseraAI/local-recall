---
id: cabc0d97-d9f0-4d4e-8ac2-e1b27b66f103
subject: >-
  UserPromptSubmit hook infinite recursion when calling claude -p without
  disabling hooks
keywords:
  - userpromptsubmit
  - hook
  - claude -p
  - recursion
  - abort error
  - child process
applies_to: 'file:src/hooks/user-prompt-submit.ts'
occurred_at: '2025-12-01T16:33:37.129Z'
content_hash: 306d7dd0cce02e08
---
When the UserPromptSubmit hook calls `claude -p` to extract keywords from user prompts, it triggers the UserPromptSubmit hook again, causing infinite recursion. This results in an 'Aborted' error from the child process.

Solution: Disable hooks when spawning the child process using the `--no-hooks` flag: `claude -p --model haiku --no-hooks`

This prevents the recursive hook invocation and allows keyword extraction to complete successfully.
