---
id: a9bf7b54-9605-441e-b80c-c3c85792139b
subject: >-
  UserPromptSubmit hook causes infinite recursion when calling claude -p without
  disabling hooks
keywords:
  - userpromptsubmit
  - hook
  - claude -p
  - recursion
  - infinite loop
  - child process
  - abort error
applies_to: 'file:src/hooks/user-prompt-submit.ts'
occurred_at: '2025-12-01T16:01:16.389Z'
content_hash: 4ae9608b2ac21eaa
---
When the UserPromptSubmit hook calls `claude -p` to extract keywords from user prompts, it triggers the UserPromptSubmit hook again in the child process, causing infinite recursion. The hook must disable itself when invoking child Claude processes to prevent this. Use the `DISABLE_HOOKS` environment variable or similar mechanism to skip hook execution in child processes.
