---
id: 24807ad5-1585-4c78-86f3-bc6fbcb15bc0
subject: Memory extraction uses Claude API with streaming for efficient token handling
keywords:
  - memory-extractor
  - claude-api
  - streaming
  - token-efficiency
applies_to: 'file:src/core/memory-extractor.ts'
occurred_at: '2025-12-01T16:23:15.982Z'
content_hash: 394f0a1aa6870a7a
---
The memory extraction process uses Claude's API with streaming enabled for efficient token handling. The extractor reads transcripts and uses a structured prompt to extract memories in JSON format. Key implementation details:

- Uses `anthropic.messages.stream()` for streamed responses
- Processes responses through `processStreamedResponse()` to accumulate text
- Extracts JSON memories from Claude's response
- Handles deduplication checking before creating new memories
- Returns both created and skipped memories with reasons

This approach is more efficient than non-streamed API calls for large transcripts.
