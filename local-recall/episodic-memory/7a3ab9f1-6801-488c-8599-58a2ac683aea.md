---
id: 7a3ab9f1-6801-488c-8599-58a2ac683aea
subject: >-
  UserPromptSubmit hook performs semantic search on user input before Claude
  processes it
keywords:
  - hooks
  - user-prompt-submit
  - semantic-search
  - vector-store
  - context-injection
applies_to: 'area:hooks'
occurred_at: '2025-12-02T21:27:44.531Z'
content_hash: 2c9add90a424e7ff
---
# UserPromptSubmit Hook Behavior

When a user submits a prompt, before Claude processes it:

1. The `UserPromptSubmit` hook is triggered
2. It receives JSON input with: `session_id`, `transcript_path`, `cwd`, and `prompt`
3. The vector store is lazily initialized (cached after first use for performance)
4. Semantic search is performed using the user's prompt as the query
5. Matching memories are injected into Claude's context

## Implementation Details

- Uses vector embeddings for semantic similarity matching
- Returns memories ranked by cosine distance similarity score (0.0 to 1.0)
- Tied scores use recency (`occurred_at`) as tiebreaker
- Vector store initialization is cached to avoid repeated startup overhead
