---
id: 8cb6c2b0-b04b-4015-86c8-7c0f95f85398
subject: Claude Code hook integration and lifecycle
keywords:
  - hooks
  - session start
  - user prompt
  - transcript
  - memory injection
  - hook configuration
applies_to: global
occurred_at: '2025-12-02T17:41:33.847Z'
content_hash: 398c45e7dbed7d9a
---
Local Recall integrates with Claude Code via hooks configured in `.claude/settings.json`:

**SessionStart Hook** (`src/hooks/session-start.ts`):
- Triggered when Claude Code session begins
- Receives JSON: `{session_id, transcript_path, cwd}`
- Loads all memories from disk (no vector store - avoids slow initialization)
- Returns 5 most recent memories sorted by `occurred_at`
- Injects memory content into Claude's context via stdout

**UserPromptSubmit Hook** (`src/hooks/user-prompt-submit.ts`):
- Triggered before Claude processes user prompt
- Receives JSON: `{session_id, transcript_path, cwd, prompt}`
- Lazy-initializes vector store (cached after first use)
- Performs semantic search using embeddings
- Injects matching memories into context via stdout

**Stop Hook**: Currently disabled - memory extraction handled by MCP server daemon instead

**Hook Commands**:
- As npm package: `node ./node_modules/local-recall/dist/hooks/session-start.js`
- From project dir: `node ./dist/hooks/session-start.js`
- Timeout: 30s for SessionStart/UserPromptSubmit, 60s for Stop
