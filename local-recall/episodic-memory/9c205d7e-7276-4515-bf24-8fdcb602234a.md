---
id: 9c205d7e-7276-4515-bf24-8fdcb602234a
subject: >-
  Memory extractor E2BIG error fixed by passing transcript via stdin instead of
  command-line arguments
keywords:
  - memory-extractor
  - e2big error
  - stdin
  - large transcripts
  - spawn
  - fix
applies_to: 'file:src/core/memory-extractor.ts'
occurred_at: '2025-12-01T16:02:57.872Z'
content_hash: 4022be13d979386d
---
The `callClaudeCLI` method in memory-extractor.ts was passing the entire transcript as a command-line argument to the `claude -p` command using `spawn('claude', ['-p', prompt, ...])`. On macOS with ARG_MAX=262144, large transcripts (>200KB) exceeded the maximum argument length, causing E2BIG errors.

Fixed by passing the transcript via stdin instead:
- Use `spawn('claude', ['-p', prompt], { stdio: ['pipe', 'pipe', 'pipe'] })`
- Write transcript to child process stdin: `child.stdin.write(transcript)`
- Call `child.stdin.end()` to signal EOF

This allows processing of arbitrarily large transcripts without hitting OS limits.
