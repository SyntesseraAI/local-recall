---
id: 69feb8b7-d90c-4067-a5d2-ddc03ac2a3ea
subject: Local Recall memory file deduplication strategy
keywords:
  - deduplication
  - content-hash
  - occurred-at
  - timestamp
  - idempotent
  - memory-files
applies_to: 'area:memory-core'
occurred_at: '2025-12-02T21:15:40.272Z'
content_hash: 3e383e7154f6d2dc
---
# Memory Deduplication Strategy

## Deduplication Mechanism

Local Recall prevents duplicate memories using two fields:

1. **occurred_at** (ISO-8601 timestamp)
   - When the original event occurred
   - Used for sorting and chronological ordering
   - Helps identify related memories from same session

2. **content_hash** (SHA-256 prefix, 16 chars)
   - Hash of the memory content
   - Enables detection of identical or very similar memories
   - Combined with `occurred_at` for duplicate detection

## Implementation

The `MemoryManager` provides:
- `findDuplicate(occurredAt, contentHash)` - Check if memory already exists
- `createMemory(data)` - Returns existing memory if duplicate found (idempotent)

## Timing Considerations

- When transcripts are updated/reprocessed, memories must be deleted and recreated
- The combination of `occurred_at` + `content_hash` is unique per memory
- This allows updating memories safely without creating orphaned records

## Why This Matters

- Multiple sessions may extract same insight (should deduplicate)
- Reprocessing transcripts shouldn't create duplicate memories
- Enables safe cleanup of outdated memories when transcripts change
