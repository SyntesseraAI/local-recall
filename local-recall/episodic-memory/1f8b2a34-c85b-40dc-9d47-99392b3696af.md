---
id: 1f8b2a34-c85b-40dc-9d47-99392b3696af
subject: >-
  Fix TypeScript error in stripMarkdownCodeBlocks when regex capture group is
  undefined
keywords:
  - typescript
  - regex
  - capture-group
  - optional-chaining
  - error-handling
  - memory-extractor
applies_to: 'file:src/core/memory-extractor.ts'
occurred_at: '2025-12-21T19:30:06.158Z'
content_hash: 9a9988049fb34aa8
---
## Problem
Build error TS2532 on line 211 of memory-extractor.ts: `codeBlockMatch[1]` could be undefined even when `codeBlockMatch` is truthy (the regex match exists but the capture group doesn't).

## Root Cause
The regex match object can exist but fail to capture the expected group if the pattern doesn't match the expected format. Direct array access doesn't account for this possibility.

## Solution
Use optional chaining with array access: `codeBlockMatch?.[1]?.trim()` instead of `codeBlockMatch[1].trim()`. This safely handles cases where either the match object or the capture group is undefined.

## Impact
Fixes build compilation and prevents potential runtime errors when processing markdown code blocks that don't match the expected format.
