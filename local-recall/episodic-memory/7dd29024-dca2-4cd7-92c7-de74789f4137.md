---
id: 7dd29024-dca2-4cd7-92c7-de74789f4137
subject: Claude's --output-format json flag may not guarantee JSON output in all cases
keywords:
  - claude cli
  - output-format
  - json parsing
  - error handling
  - malformed responses
applies_to: global
occurred_at: '2025-12-01T23:06:36.551Z'
content_hash: 22b27a6384e78369
---
When calling Claude via the CLI with `--output-format json`, there are edge cases where Claude's response is not valid JSON, even with the flag set. This can happen when:

- Claude returns error messages or warnings before/after the JSON
- The JSON structure is incomplete or malformed
- Edge cases in transcript processing cause parsing issues

**Recommendation:** When parsing Claude CLI responses:
1. Attempt to parse the full response as JSON first
2. If that fails, try to extract a JSON object/array from the response (look for `[` or `{`)
3. Add appropriate error handling and logging for parse failures
4. Never assume valid JSON output without validation, even with the flag set

This is a known edge case with CLI tools that output JSON.
