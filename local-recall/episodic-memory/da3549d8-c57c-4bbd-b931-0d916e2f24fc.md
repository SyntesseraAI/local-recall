---
id: da3549d8-c57c-4bbd-b931-0d916e2f24fc
subject: UserPromptSubmit hook causes recursion when calling claude -p CLI
keywords:
  - hook
  - recursion
  - claude-p
  - user-prompt-submit
  - stdin
  - bug
applies_to: global
occurred_at: '2025-12-01T16:00:21.565Z'
content_hash: f687b067a50a3e36
---
The UserPromptSubmit hook invokes `claude -p` to extract keywords from user prompts. However, this creates a recursion problem: the inner Claude process also triggers UserPromptSubmit, which calls `claude -p` again, potentially creating infinite loops.

**Solution**: Disable hooks when invoking Claude CLI tools by using the `--no-hooks` flag or setting `CLAUDE_DISABLE_HOOKS=true` environment variable. This prevents recursive hook execution.
