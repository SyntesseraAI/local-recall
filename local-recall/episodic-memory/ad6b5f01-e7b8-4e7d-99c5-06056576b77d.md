---
id: ad6b5f01-e7b8-4e7d-99c5-06056576b77d
subject: Memory deduplication uses occurred_at timestamp and content_hash
keywords:
  - deduplication
  - memory
  - duplicate-detection
  - content-hash
  - occurred-at
  - idempotent
applies_to: global
occurred_at: '2025-12-02T02:22:33.945Z'
content_hash: 8a26789da8fb2a75
---
# Memory Deduplication Mechanism

Memories are deduplicated using two fields:

1. **occurred_at** - ISO-8601 timestamp of when the original event occurred
2. **content_hash** - SHA-256 hash prefix (16 characters) of the memory content

## How It Works

The `findDuplicate()` function in memory.ts checks if a memory with the same `occurred_at` and `content_hash` already exists. If found, the existing memory is returned instead of creating a new one.

## Idempotent Creation

This design makes `createMemory()` idempotent - calling it multiple times with the same content and timestamp will return the same memory without creating duplicates.

## Important Notes

- The `occurred_at` field is crucial for deduplication - it represents when the original event/insight occurred, not when the memory was created
- The content_hash allows detecting when memory content changes (if occurred_at is the same but content differs, it's treated as a new memory)
- This is why memories don't have an update operation - they're immutable after creation
