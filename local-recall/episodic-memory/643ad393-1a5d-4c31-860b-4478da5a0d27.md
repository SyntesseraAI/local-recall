---
id: 643ad393-1a5d-4c31-860b-4478da5a0d27
subject: >-
  Transcript collector must handle JSONL format and deduplicate entries by
  content hash
keywords:
  - transcript
  - jsonl
  - parser
  - deduplication
  - content-hash
  - collection
  - formatting
applies_to: 'file:src/core/transcript-collector.ts'
occurred_at: '2025-12-01T16:33:04.472Z'
content_hash: e9ff7dfdee4d9a1d
---
# Transcript Collection and Parsing

## JSONL Format Handling

Claude transcripts are stored in JSONL format (one JSON object per line). When collecting transcripts:
- Read files line-by-line
- Parse each line as separate JSON (don't assume whole file is valid JSON array)
- Handle potential newlines within JSON strings correctly
- Build a consolidated view of the entire transcript session

## Deduplication Strategy

Transcripts should be deduplicated and condensed to avoid redundant processing:
- Generate content hashes for transcript data to identify duplicates
- Store hash of last processed transcript state
- Only reprocess if content has changed (new hash)
- Condense transcripts: combine consecutive messages from same sender, remove duplicate information

## Implementation Details

- Use a streaming line-by-line parser rather than loading entire JSONL at once
- Calculate SHA-256 hash of transcript content for change detection
- Build consolidated transcript format that merges repeated patterns
- Consider formatting improvements: standardize timestamps, clean formatting for better readability
