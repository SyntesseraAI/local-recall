---
id: c6bd4434-0be5-42d9-801b-280fcfb73f37
subject: Internal prompt detection in hooks prevents memory extraction feedback loops
keywords:
  - internal-prompt
  - LOCAL_RECALL_INTERNAL
  - memory-extraction
  - transcript-processing
applies_to: 'file:src/hooks/user-prompt-submit.ts'
occurred_at: '2025-12-21T18:32:04.567Z'
content_hash: 48005a3cf05831e4
---
The UserPromptSubmit hook skips any prompt containing `[LOCAL_RECALL_INTERNAL]` marker. This prevents feedback loops when the MCP daemon calls `claude -p` to extract memories from transcripts. The marker is added programmatically by the transcript processing code to distinguish between user prompts and internal extraction calls.
