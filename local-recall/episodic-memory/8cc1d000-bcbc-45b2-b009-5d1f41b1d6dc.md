---
id: 8cc1d000-bcbc-45b2-b009-5d1f41b1d6dc
subject: >-
  Session guarding requires [LOCAL_RECALL_INTERNAL] prefix on memory extraction
  prompts
keywords:
  - session guarding
  - memory extraction
  - prompt prefix
  - hook filtering
  - recursion prevention
applies_to: global
occurred_at: '2025-12-03T09:48:52.171Z'
content_hash: 33d333ba2d68e52e
---
The UserPromptSubmit hook filters prompts by checking for the `[LOCAL_RECALL_INTERNAL]` prefix at line 161 of `src/hooks/user-prompt-submit.ts`. The memory extraction prompt in `src/prompts/memory-extraction.ts` must include this prefix (added at line 62-63) to prevent the MCP daemon's `claude -p` calls from being processed by the hook again, which would cause infinite recursion.
