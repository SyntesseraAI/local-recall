---
id: 5c34588a-73ec-4bde-a6a5-a8e158327fad
subject: UserPromptSubmit hook uses lazy-initialized vector store for semantic search
keywords:
  - user prompt submit
  - semantic search
  - lazy initialization
  - vector embeddings
applies_to: 'file:src/hooks/user-prompt-submit.ts'
occurred_at: '2025-12-02T11:52:09.734Z'
content_hash: 9257bcc4d46ca176
---
The UserPromptSubmit hook is triggered when a user submits a prompt, before Claude processes it:

1. Receives JSON input with `session_id`, `transcript_path`, `cwd`, `prompt`
2. Initializes the vector store on first use (lazy initialization, cached after first use)
3. Performs semantic search using vector embeddings
4. Outputs matching memories to stdout (injected into Claude's context)

The vector store initialization is lazy to avoid overhead on every prompt - it's only set up once per session.
