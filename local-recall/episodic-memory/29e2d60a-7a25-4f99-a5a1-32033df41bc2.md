---
id: 29e2d60a-7a25-4f99-a5a1-32033df41bc2
subject: >-
  Memory extraction uses Claude Haiku with structured prompt and JSON schema
  validation
keywords:
  - memory extraction
  - claude haiku
  - json schema
  - transcript processing
  - memory-extractor.ts
applies_to: 'file:src/core/memory-extractor.ts'
occurred_at: '2025-12-01T23:05:12.764Z'
content_hash: 3029b28fb5978c07
---
The memory extraction process in memory-extractor.ts uses Claude Haiku (haiku-4-5 model) to process transcripts and extract memories. It uses a structured prompt from src/prompts/memory-extraction.ts and validates the response against a JSON schema. The extraction follows specific rules:

- Memories are extracted from condensed transcript events
- Each memory has subject, keywords, applies_to scope, and content fields
- Keywords should be lowercase and specific (1-10 keywords per memory)
- applies_to can be 'global', 'file:<path>', or 'area:<name>'
- The response is validated to ensure memories meet quality standards
- Handles errors gracefully if extraction fails or returns invalid JSON
