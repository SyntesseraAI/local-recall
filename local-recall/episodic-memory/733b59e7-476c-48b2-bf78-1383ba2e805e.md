---
id: 733b59e7-476c-48b2-bf78-1383ba2e805e
subject: >-
  Hooks architecture: SessionStart injects recent memories, UserPromptSubmit
  performs semantic search
keywords:
  - hooks
  - session-start
  - user-prompt-submit
  - context-injection
  - semantic-search
applies_to: global
occurred_at: '2025-12-21T19:22:52.588Z'
content_hash: ba9e43cdaddc1dab
---
Claude Code integration uses two main hooks:

**SessionStart Hook** (`session-start.js`): Reads 5 most recent memories directly from files (sorted by `occurred_at`) and outputs to stdout for context injection. No search needed.

**UserPromptSubmit Hook** (`user-prompt-submit.js`): Unified hook handling both episodic and thinking memories. Performs semantic search using Orama + Ollama embeddings, filters by similarity threshold and token budget, then injects results. Skips internal prompts containing `[LOCAL_RECALL_INTERNAL]` marker.

**Stop Hook**: Currently disabled. Memory extraction now handled by MCP server daemon running every 5 minutes.
