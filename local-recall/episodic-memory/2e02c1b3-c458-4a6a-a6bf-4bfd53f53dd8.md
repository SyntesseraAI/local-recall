---
id: 2e02c1b3-c458-4a6a-a6bf-4bfd53f53dd8
subject: 'ONNX runtime causes mutex errors in concurrent hook execution, not sqlite-vec'
keywords:
  - mutex
  - onnx
  - fastembed
  - concurrency
  - embedding
  - error
  - hook
applies_to: global
occurred_at: '2025-12-21T19:19:42.881Z'
content_hash: 67dc40ec65e3adfd
---
The mutex errors occurring during concurrent hook execution are caused by ONNX runtime (used by fastembed embedding library), not sqlite-vec. When multiple Claude instances or concurrent processes try to load the ONNX embedding model simultaneously, they encounter system-level mutex conflicts. The proper-lockfile mechanism doesn't prevent ONNX's internal mutex issues. This was confirmed through testing with 15 concurrent processes, all producing mutex errors.
