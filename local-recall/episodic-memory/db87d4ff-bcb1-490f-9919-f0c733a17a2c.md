---
id: db87d4ff-bcb1-490f-9919-f0c733a17a2c
subject: Memory deduplication uses content_hash field to prevent duplicate memories
keywords:
  - deduplication
  - duplicate-detection
  - content-hash
  - sha256
  - memory-creation
  - idempotent
applies_to: 'file:src/core/memory.ts'
occurred_at: '2025-12-02T01:42:08.089Z'
content_hash: a7ab0eae66f898b3
---
# Memory Deduplication Strategy

The memory system uses a `content_hash` field to detect and prevent duplicate memories.

## How It Works

1. When creating a memory, the content is hashed using SHA-256
2. The first 16 characters of the hash are stored in the `content_hash` field
3. The `findDuplicate(occurredAt, contentHash)` function checks if a memory with the same `occurred_at` timestamp and `content_hash` already exists
4. If a duplicate is found, the function returns the existing memory instead of creating a new one
5. This makes memory creation idempotent - calling it multiple times with the same content won't create duplicates

## Use Case

This is critical for the transcript daemon which processes transcripts every 5 minutes. When a transcript hasn't changed, the extracted memories won't be recreated as duplicates.

## Important Note

The `occurred_at` field is also part of the deduplication check - two memories with the same content but different timestamps are not considered duplicates.
