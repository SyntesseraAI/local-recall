---
id: 68f363fd-2cff-4d40-b25d-3db84af42b6d
subject: >-
  Stop hook changed to process entire transcript history instead of 30-second
  window
keywords:
  - stop_hook
  - transcript
  - processing
  - time_window
  - history
applies_to: 'file:src/hooks/stop.ts'
occurred_at: '2025-12-21T18:20:12.298Z'
content_hash: c6b425c6cd518e6b
---
# Stop Hook History Processing

## Previous Behavior
- Filtered transcript messages to only those within 30 seconds of stop event
- Messages older than 30 seconds were discarded
- Result: Most memories weren't created because messages had aged out

## New Behavior
- Processes entire transcript history from the session
- No time-based filtering
- Relies on deduplication (occurred_at + content_hash) to prevent creating duplicate memories on repeated hook runs

## Implication
Memory extraction is more comprehensive, captures the full session's learning even if hook runs at the very end of a long session.
