---
id: 73a5eba7-8a1c-4cef-a0ae-70a33e59c57d
subject: Search hooks use Orama directly without file-locking coordination
keywords:
  - hooks
  - search
  - orama
  - session-start
  - user-prompt-submit
applies_to: 'file:src/hooks/user-prompt-submit.ts'
occurred_at: '2025-12-21T19:40:43.728Z'
content_hash: 38cd2a7652728146
---
The search hooks (SessionStart and UserPromptSubmit) load and search Orama indexes directly:

- They call `vectorStore.initialize()` which loads the JSON index file
- No file-locking or coordination
- In multi-instance scenarios, they may read corrupted/partial index files

The graceful degradation strategy:
- If index loads with JSON parse error, VectorStore rebuilds from scratch
- Searches continue to work even if index is partially corrupted
- This prevents complete system failure but may miss some memories temporarily
