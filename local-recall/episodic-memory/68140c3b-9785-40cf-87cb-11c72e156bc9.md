---
id: 68140c3b-9785-40cf-87cb-11c72e156bc9
subject: Memory extractor uses Claude Haiku via claude -p for efficient extraction
keywords:
  - memory-extractor
  - claude-haiku
  - extraction
  - performance
  - subprocess
applies_to: 'file:src/core/memory-extractor.ts'
occurred_at: '2025-12-02T01:31:09.665Z'
content_hash: a524a15dc2521301
---
The memory extractor spawns Claude Haiku as a subprocess using `claude -p` to extract memories from transcripts. This approach:
- Uses the lightweight Haiku model for cost efficiency
- Processes transcripts asynchronously through the MCP server daemon
- Extracts multiple memories per transcript with deduplication logic
- Stores memories atomically and checks for duplicates by content_hash and occurred_at

Key implementation details:
- Spawns subprocess: `claude -p --model haiku`
- Passes transcript content and extraction prompt as stdin
- Parses JSON response containing memory objects
- Handles errors gracefully with logging
- Uses timeout to prevent hanging processes
