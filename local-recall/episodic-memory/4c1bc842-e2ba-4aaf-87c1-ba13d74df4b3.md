---
id: 4c1bc842-e2ba-4aaf-87c1-ba13d74df4b3
subject: 'ONNX runtime mutex errors occur with concurrent hook execution, not sqlite-vec'
keywords:
  - onnx
  - mutex
  - concurrent
  - fastembed
  - embedding
  - threading
applies_to: global
occurred_at: '2025-12-21T18:25:17.343Z'
content_hash: 156643e9aed11216
---
The mutex errors during concurrent hook execution are caused by ONNX runtime (used by fastembed), not sqlite-vec. When multiple Claude instances run hooks concurrently, they attempt to load the ONNX embedding model simultaneously, triggering system-level mutex conflicts. This happens even with proper-lockfile preventing file-based races, because ONNX has internal threading issues. The Orama migration successfully eliminated sqlite-vec issues, but the embedding model loading remains the bottleneck for concurrent hooks.
