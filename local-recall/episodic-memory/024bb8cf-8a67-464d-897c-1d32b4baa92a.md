---
id: 024bb8cf-8a67-464d-897c-1d32b4baa92a
subject: >-
  Transcript collector needs to handle concurrent file writes from active Claude
  sessions
keywords:
  - transcript
  - collector
  - concurrency
  - file-writes
  - jsonl
  - synchronization
applies_to: 'file:src/core/transcript-collector.ts'
occurred_at: '2025-12-02T07:54:12.441Z'
content_hash: bbdff610547be2de
---
# Transcript Concurrency Considerations

When collecting transcripts from active Claude Code sessions:

## File Write Conflicts

Claude writes to transcript files while sessions are active. The transcript collector must handle:
- Files being written to concurrently
- Partial lines at end of file (incomplete JSON objects)
- Files that grow while being read

## Recommended Approach

1. **Line-by-line parsing**: Read JSONL files line-by-line rather than loading the entire file
2. **Error handling**: Gracefully skip incomplete/malformed JSON lines
3. **Seek positions**: Track file positions to avoid re-reading duplicate entries
4. **Timing**: Consider delaying collection for recently-active sessions

## Alternative Solutions

- Could use file locking mechanisms (OS-dependent)
- Could wait for session to complete before full processing
- Could implement exponential backoff for retrying failed parses
