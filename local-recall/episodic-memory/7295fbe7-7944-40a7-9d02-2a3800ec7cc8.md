---
id: 7295fbe7-7944-40a7-9d02-2a3800ec7cc8
subject: Memory extraction processes internal system prompts causing infinite recursion
keywords:
  - memory extraction
  - bug
  - recursion
  - LOCAL_RECALL_INTERNAL
  - transcript processing
  - infinite loop
  - transcript collector
applies_to: global
occurred_at: '2025-12-01T16:28:25.682Z'
content_hash: 608afebd2d227a3b
---
The transcript collection and memory extraction system has a critical bug: it processes `[LOCAL_RECALL_INTERNAL]` prefixed messages from transcripts. These messages are actually the system's own internal prompts being echoed back into transcripts, creating an infinite recursion loop where:

1. System sends `[LOCAL_RECALL_INTERNAL]` prompt to analyze transcripts
2. Transcript includes this prompt as a message
3. Memory extraction tries to process the `[LOCAL_RECALL_INTERNAL]` prompt
4. This creates a recursive loop where the internal prompt keeps getting reprocessed

This needs to be fixed in the transcript collector to:
- Filter out `[LOCAL_RECALL_INTERNAL]` prefixed messages before processing
- Only process actual user and assistant interactions
- Prevent system prompts from being included in transcript analysis

See src/core/transcript-collector.ts for the transcript processing logic.
