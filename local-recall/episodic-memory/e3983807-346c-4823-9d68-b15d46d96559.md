---
id: e3983807-346c-4823-9d68-b15d46d96559
subject: Local Recall memory extraction and MCP server synchronization
keywords:
  - memory
  - extraction
  - mcp
  - server
  - transcript
  - daemon
  - background
applies_to: global
occurred_at: '2025-12-02T16:59:26.008Z'
content_hash: 29a1eea4e4970389
---
# Memory Extraction and Sync Process

Local Recall has two complementary memory systems:

## MCP Server Background Daemon

The MCP server runs a background daemon that:
1. Monitors Claude's project transcript directory
2. Processes new transcripts every 5 minutes
3. Extracts memories using Claude's API (`claude -p` prompt)
4. Tracks processed transcripts by content hash to detect changes
5. Deletes and recreates memories when transcripts change

## Memory Extraction

The extraction process uses:
- `transcript-collector.ts` - Collects transcripts from Claude cache
- `transcript-condenser.ts` - Condenses transcripts for processing
- `memory-extractor.ts` - Extracts memories from transcripts
- `processed-log.ts` - Tracks which transcripts have been processed

## Key Implementation Details

- Memories are idempotent - duplicates are detected via `occurred_at` + `content_hash`
- Vector embeddings are generated automatically when memories are added
- Memory extraction happens asynchronously, not blocking the hooks
- The system handles partial/interrupted downloads by detecting incomplete cache files
