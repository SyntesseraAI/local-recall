---
id: 47316b87-1684-42cf-a26c-2efaf9df4ab0
subject: >-
  Memory extraction happens in MCP daemon, not in Stop hook - architectural
  decision
keywords:
  - memory-extraction
  - mcp-daemon
  - stop-hook
  - architecture
  - background-processing
  - async
  - transcript-processing
applies_to: global
occurred_at: '2025-12-01T16:11:42.425Z'
content_hash: c48d56b9180d233c
---
# Memory Extraction Architecture

## Current Design

Memory extraction is NOT handled by the Stop hook. Instead:
- The MCP server runs a background daemon
- The daemon processes transcripts asynchronously
- Runs every 5 minutes
- Uses `claude -p` to extract memories from transcript content

## Why This Approach

1. **Non-blocking**: Stop hook stays lightweight and fast
2. **Reliable**: Failures in memory extraction don't block Claude Code
3. **Flexible**: Can retry processing failed transcripts
4. **Background**: Doesn't slow down the user's coding session

## Stop Hook Status

The Stop hook is currently disabled in the codebase. Memory extraction is handled entirely by the MCP daemon.

## Implementation Details

- Daemon tracks processed transcripts using content hashes
- Detects changes in transcripts and reprocesses them
- Creates/updates memories based on Claude's extraction
- Runs independently from user interactions
