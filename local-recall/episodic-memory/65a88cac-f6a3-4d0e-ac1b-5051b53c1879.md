---
id: 65a88cac-f6a3-4d0e-ac1b-5051b53c1879
subject: Local Recall transcript collection and memory extraction workflow
keywords:
  - mcp-server
  - daemon
  - transcript-collector
  - memory-extractor
  - async-processing
  - background
applies_to: global
occurred_at: '2025-12-02T21:32:07.619Z'
content_hash: 2809c4a02113cd7d
---
# Local Recall Background Processing Workflow

The Local Recall system uses an asynchronous background daemon (part of the MCP server) to process Claude Code transcripts and extract memories.

## Processing Pipeline

1. **Transcript Collection** (`transcript-collector.ts`)
   - Monitors `~/.claude/projects/<project>/transcripts/` directory
   - Collects JSONL transcript files from Claude Code sessions
   - Runs periodically (every 5 minutes in daemon mode)

2. **Transcript Condensing** (`transcript-condenser.ts`)
   - Takes raw transcripts and condenses them into summary format
   - Removes verbose intermediate steps while preserving key information
   - Formats for memory extraction processing

3. **Memory Extraction** (`memory-extractor.ts`)
   - Analyzes condensed transcripts using Claude's API
   - Extracts actionable memories from session events
   - Creates structured memory files with YAML frontmatter

4. **Processed Tracking** (`processed-log.ts`)
   - Maintains a log of already-processed transcripts
   - Uses content hashes to detect changes
   - Prevents reprocessing of unchanged transcripts

## Key Design Decisions

- Background processing decouples transcript collection from hook latency
- The `Stop` hook is disabled - memory extraction happens asynchronously
- Processing happens every 5 minutes to catch new sessions
- Change detection via content hashes allows reprocessing if transcripts change

## Why This Approach

- Hooks must complete quickly (within their timeout) - transcript processing is expensive
- The Stop hook would block session completion while processing
- Asynchronous processing allows users to work uninterrupted while memories are created
