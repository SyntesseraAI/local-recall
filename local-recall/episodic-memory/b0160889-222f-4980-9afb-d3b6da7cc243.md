---
id: b0160889-222f-4980-9afb-d3b6da7cc243
subject: 'Memory extraction prompt structure: starts with [LOCAL_RECALL_INTERNAL] prefix'
keywords:
  - memory extraction
  - prompt prefix
  - internal guard
  - session guarding
applies_to: 'file:src/prompts/memory-extraction.ts'
occurred_at: '2025-12-21T19:22:59.576Z'
content_hash: c21b8e23bfdc0de4
---
All memory extraction prompts must start with the `[LOCAL_RECALL_INTERNAL]` prefix (on line 62-63 of `buildMemoryExtractionPrompt()`). This prefix is detected by the UserPromptSubmit hook (line 161 of `user-prompt-submit.ts`) to skip processing internal prompts and prevent recursion. Without this prefix, the memory extraction prompt itself will be processed as a regular prompt.
