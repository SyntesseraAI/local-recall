---
id: eeaeb765-5c76-4c97-b495-205e27ace6f1
subject: Hooks execute but return empty stdout - breaks memory injection for users
keywords:
  - hooks
  - empty stdout
  - SessionStart
  - UserPromptSubmit
  - bug
  - memory injection
applies_to: global
occurred_at: '2025-12-21T17:33:39.098Z'
content_hash: cb99a8cde62d6cce
---
## Problem

Hooks (SessionStart and UserPromptSubmit) are executing successfully but returning empty stdout. This breaks memory injection because Claude's hook system requires non-empty stdout to inject content into the context.

## Root Cause

The hooks are running the compiled JavaScript files but not outputting the formatted memory content to stdout. The user can see debug logs in recall.log showing memories are being found/searched, but nothing is being printed to stdout.

## Impact

Without stdout output:
- SessionStart hook: Recent memories are not injected at session beginning
- UserPromptSubmit hook: Relevant memories are not injected before processing user prompts
- Users lose the entire benefit of the memory system

## Technical Details

Hook execution flow:
1. Claude Code triggers hook event
2. Hook command executes: `node ./dist/hooks/session-start.js`
3. Hook receives JSON input via stdin (session_id, transcript_path, cwd)
4. Hook should output formatted memory content to stdout
5. Claude Code injects stdout content into context

Current behavior: Steps 1-3 work, but step 4 returns empty string instead of formatted memories.

## Next Steps for Debugging

- Check that hooks are actually calling console.log/stdout.write with formatted memory content
- Verify the stdout output includes proper formatting (markdown headers, memory content, metadata)
- Ensure hook output is not being captured/redirected elsewhere
- Test stdout explicitly in hook code

## Files Involved

- `src/hooks/session-start.ts` - SessionStart hook
- `src/hooks/user-prompt-submit.ts` - UserPromptSubmit hook
- `dist/hooks/session-start.js` - Compiled hook
- `dist/hooks/user-prompt-submit.js` - Compiled hook
