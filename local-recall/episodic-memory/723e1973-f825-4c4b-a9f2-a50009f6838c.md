---
id: 723e1973-f825-4c4b-a9f2-a50009f6838c
subject: >-
  Memory extraction uses Claude Haiku with structured prompting for transcript
  analysis
keywords:
  - memory-extractor
  - claude-haiku
  - transcript
  - prompt-engineering
  - extraction
applies_to: 'file:src/core/memory-extractor.ts'
occurred_at: '2025-12-01T15:56:25.391Z'
content_hash: 4aacecab97d1687d
---
The memory extraction system uses Claude Haiku model via the Anthropic SDK to analyze session transcripts. The extraction process:

1. Uses `Anthropic.parseContentBlock()` to extract JSON from Claude's responses
2. Implements retry logic with exponential backoff for API calls
3. Provides structured prompts that define memory format requirements
4. Validates extracted memories against the memory interface schema
5. Filters out invalid memories and handles errors gracefully

Key implementation details:
- Extraction happens asynchronously using TypeScript async/await
- The system catches `APIError` exceptions and implements retry logic
- Memories must match the `Memory` interface with required fields: id, subject, keywords, applies_to, occurred_at, content_hash
- Invalid extraction results are logged but don't crash the system
