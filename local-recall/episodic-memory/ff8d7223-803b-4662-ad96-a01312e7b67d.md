---
id: ff8d7223-803b-4662-ad96-a01312e7b67d
subject: Plugin system requires bundled MCP SDK dependencies
keywords:
  - plugin
  - mcp
  - bundling
  - esbuild
  - dependencies
  - deployment
  - server.js
applies_to: 'file:package.json'
occurred_at: '2025-12-21T18:31:15.659Z'
content_hash: 596a01effe4d991c
---
The Claude plugin marketplace deployment requires MCP SDK to be bundled into server.js since the plugin cache doesn't ship with node_modules. The build script had `--external:@modelcontextprotocol/sdk` which prevented bundling, causing MCP server startup failures in plugin-based installations.

**Solution**: Remove the `--external:@modelcontextprotocol/sdk` flag from the esbuild configuration in the build:scripts command. This increases server.js size from ~704KB to ~1.1MB but makes it self-contained and deployable without external dependencies.

**For existing broken installations**: Manually copy the rebuilt server.js to the plugin cache at `~/.claude/plugins/cache/local-recall-marketplace/local-recall/0.1.0/scripts/mcp-server/server.js` or reinstall the plugin through Claude's UI.
