---
id: dcc61821-9a82-4453-a1c9-fc8ffa10b929
subject: Node.js spawn() hangs when Claude CLI stdin is piped but not closed
keywords:
  - spawn
  - stdio
  - stdin
  - claude-cli
  - hang
  - timeout
  - node.js
applies_to: global
occurred_at: '2025-12-21T19:32:21.797Z'
content_hash: 1275fd1de3b76f77
---
When spawning the Claude CLI process using Node.js's `child_process.spawn()` with `stdio: ['pipe', 'pipe', 'pipe']`, the CLI hangs indefinitely waiting for stdin to be closed. This causes hook timeouts after 30 seconds.

The fix is to use `stdio: ['ignore', 'pipe', 'pipe']` instead, which tells the child process to ignore stdin. This allows the Claude CLI to complete normally (~2-3 seconds) instead of hanging.

Affected files:
- `src/hooks/user-prompt-submit.ts:53` - callClaudeForKeywords function
- `src/core/memory-extractor.ts` - extractMemoriesFromTranscript function

This pattern applies to any spawning of the `claude` CLI in the codebase.
