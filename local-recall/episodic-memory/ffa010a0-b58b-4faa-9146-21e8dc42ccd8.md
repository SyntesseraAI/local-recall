---
id: ffa010a0-b58b-4faa-9146-21e8dc42ccd8
subject: Memory extractor now uses Claude Haiku with JSON-only output validation
keywords:
  - memory extractor
  - haiku model
  - json schema
  - claude cli
  - single turn
applies_to: 'file:src/core/memory-extractor.ts'
occurred_at: '2025-12-21T19:22:59.576Z'
content_hash: 3c40b162e714d1bb
---
Updated `callClaudeCLI()` method to use `--model haiku` instead of default model for faster, cheaper memory extraction. Also added `--max-turns 1` to enforce single-turn responses and added JSON schema validation to ensure Claude returns only valid JSON without explanatory text. The memory extraction prompt in `src/prompts/memory-extraction.ts` was updated to explicitly state 'Return ONLY a valid JSON object with no explanation, no markdown formatting, no code blocks - just raw JSON' (line 120).
