---
id: 1e9b1240-8b0d-49ce-aa30-30beb300b6ac
subject: >-
  UserPromptSubmit hook performs lazy-initialized semantic search before Claude
  processes prompt
keywords:
  - hooks
  - user-prompt
  - semantic-search
  - vector-store
applies_to: 'area:hooks'
occurred_at: '2025-12-02T17:47:03.554Z'
content_hash: fba4ae711ba20d4a
---
The UserPromptSubmit hook is triggered when a user submits a prompt, before Claude processes it. It:
1. Receives JSON input with session_id, transcript_path, cwd, prompt
2. Lazily initializes the vector store on first use (cached after initialization)
3. Performs semantic search using vector embeddings
4. Outputs matching memories to stdout (injected into Claude's context)

The vector store initialization is deferred to avoid slowing down SessionStart.
