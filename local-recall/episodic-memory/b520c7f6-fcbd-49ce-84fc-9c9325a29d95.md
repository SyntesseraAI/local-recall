---
id: b520c7f6-fcbd-49ce-84fc-9c9325a29d95
subject: UserPromptSubmit hook calls claude -p which triggers the same hook recursively
keywords:
  - userpromptsubmit
  - hook
  - claude
  - recursion
  - infinite loop
  - keyword extraction
applies_to: 'file:src/hooks/user-prompt-submit.ts'
occurred_at: '2025-12-01T22:19:09.045Z'
content_hash: 919c204b33ababc7
---
The UserPromptSubmit hook invokes `claude -p` to extract keywords from user prompts. However, this command execution triggers the UserPromptSubmit hook again within the child process, creating a recursive loop. This is a critical issue that needs to be addressed by either:

1. Disabling the hook during keyword extraction
2. Using an alternative method to extract keywords that doesn't trigger the hook
3. Implementing loop detection to prevent infinite recursion

This problem affects the stability and performance of the memory system when prompts are submitted.
