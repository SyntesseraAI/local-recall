---
id: d250b57a-4ad1-456d-a423-8a7677dcc47a
subject: Memory extraction uses multiple passes with error recovery and deduplication
keywords:
  - memory-extraction
  - transcript
  - deduplication
  - error-handling
  - content-hash
  - occurred-at
  - retry-logic
applies_to: 'file:src/core/memory-extractor.ts'
occurred_at: '2025-12-02T07:39:24.981Z'
content_hash: 95492cf85281a271
---
# Memory Extraction Process

## Multi-Pass Extraction

Memory extraction uses multiple passes to handle edge cases:

1. **First Pass**: Extract memories with full accuracy (using `ContentHashingExtractor`)
2. **Error Recovery Pass**: If first pass fails, use `BasicExtractor` with error recovery
3. **Fallback**: Extract at least basic event memories if all else fails

## Deduplication Strategy

Memories are deduplicated using:
- `content_hash`: SHA-256 hash of memory content (stored as 16-char prefix)
- `occurred_at`: ISO-8601 timestamp when the event happened

The `findDuplicate()` method checks for existing memories with matching hash and timestamp before creating new ones.

## Implementation Details

- Use `createMemory()` which handles deduplication automatically
- Always include `occurred_at` and let the system compute `content_hash`
- Keep extraction logic robust with try-catch for edge cases
- Log extraction results for debugging
