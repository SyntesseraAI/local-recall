---
id: 407381ba-62fa-4d6f-bc4f-b4895ad618ec
subject: >-
  Memory deduplication uses occurred_at timestamp and content_hash for change
  detection
keywords:
  - memory
  - deduplication
  - occurred-at
  - content-hash
  - change-detection
applies_to: 'file:src/core/memory.ts'
occurred_at: '2025-12-01T15:53:03.464Z'
content_hash: 09a1c6fd87c1ef36
---
# Memory Deduplication Strategy

The system uses two fields for memory deduplication:

1. **occurred_at**: ISO-8601 timestamp of when the original event occurred (helps with temporal grouping)
2. **content_hash**: SHA-256 hash prefix (16 chars) of the memory content

## Duplicate Detection

The `findDuplicate(occurredAt, contentHash)` method in memory.ts checks for existing memories with:
- Same `occurred_at` timestamp
- Same `content_hash` value

If a match is found, the existing memory is returned instead of creating a duplicate.

## MCP Daemon Usage

The background daemon uses content hashing to:
- Detect when a transcript has changed
- Delete old memories if the transcript content changed
- Recreate memories from the updated transcript
- Avoid creating duplicate memories for unchanged transcripts
