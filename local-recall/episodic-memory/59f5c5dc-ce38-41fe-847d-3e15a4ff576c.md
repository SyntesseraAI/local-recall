---
id: 59f5c5dc-ce38-41fe-847d-3e15a4ff576c
subject: Refactored vector search from SQLite+sqlite-vec to Orama
keywords:
  - refactor
  - orama
  - vector-search
  - sqlite-vec
  - pure-javascript
applies_to: global
occurred_at: '2025-12-03T11:22:58.632Z'
content_hash: a2e74d7f3d78b080
---
# Vector Search Architecture Refactoring

The project replaced the SQLite + sqlite-vec architecture with Orama, a pure JavaScript search engine.

## Key Changes

### Motivation
- sqlite-vec requires native extensions that cause mutex lock errors when multiple processes load them concurrently
- Orama is pure JavaScript, eliminating these concurrency issues

### What Was Removed
- `src/core/database.ts` - Database utility module
- `src/mcp-server/http-server.ts` - HTTP communication layer
- `src/utils/daemon-client.ts` - Daemon HTTP client
- Hook-daemon architecture that used HTTP to avoid concurrent sqlite-vec loading

### What Changed
- Hooks now work directly without needing to communicate with a daemon via HTTP
- Memory search and retrieval operations simplified
- Vector embeddings still use fastembed, but storage/search now uses Orama

### Migration Impact
- 114 files changed (+3,120 / -1,843 lines)
- Eliminates the complex HTTP communication pattern between hooks and daemon
- Simpler deployment and configuration
- Better compatibility with Claude Code's hook system
