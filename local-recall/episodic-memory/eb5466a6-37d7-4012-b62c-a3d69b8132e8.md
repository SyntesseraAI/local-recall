---
id: eb5466a6-37d7-4012-b62c-a3d69b8132e8
subject: >-
  Memory extraction uses streaming API with dynamic token budgeting for
  transcript processing
keywords:
  - memory extraction
  - streaming API
  - token budgeting
  - transcript processing
  - claude API
applies_to: 'file:src/core/memory-extractor.ts'
occurred_at: '2025-12-01T22:45:05.328Z'
content_hash: 9c43db5a9a3fc33a
---
The memory extraction system in memory-extractor.ts uses Claude's streaming API (`Anthropic` client with `stream()` method) to process transcripts. It implements dynamic token budgeting:

- Streams are processed in chunks as they arrive
- Token budget is calculated based on available context
- When approaching token limits, the system gracefully handles overflow
- Uses `event.type === 'content_block_delta'` to detect streaming chunks
- Accumulates extracted memories as the stream processes

This streaming approach allows processing of large transcripts without hitting token limits by processing incrementally rather than all at once.
