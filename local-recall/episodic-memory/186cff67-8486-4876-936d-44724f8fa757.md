---
id: 186cff67-8486-4876-936d-44724f8fa757
subject: Plugin hooks were using stale better-sqlite3 dependency that no longer exists
keywords:
  - plugin
  - hooks
  - better-sqlite3
  - stale code
  - orama
  - migration
applies_to: 'area:plugin'
occurred_at: '2025-12-21T18:28:29.693Z'
content_hash: 642d73cab0729dae
---
The dev-marketplace/local-recall-plugin had stale hook files (user-prompt-submit-thinking.js) that tried to import 'better-sqlite3'. This was from an older version before the codebase migrated to Orama (pure JavaScript vector store). The plugin's hooks.json configuration was pointing to these deleted files, causing ERR_MODULE_NOT_FOUND errors when hooks tried to execute.

**Solution:**
- Deleted the stale user-prompt-submit-thinking.js file
- Updated hooks.json to point to user-prompt-submit.js (the unified hook that handles both episodic and thinking memories)
- Rebuilt the plugin scripts to use current dependencies

The main src/hooks/ files already use Orama correctly, but the plugin needed its hooks.json and bundled scripts to be updated to match.
