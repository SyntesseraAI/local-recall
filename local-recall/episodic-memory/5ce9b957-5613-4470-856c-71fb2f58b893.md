---
id: 5ce9b957-5613-4470-856c-71fb2f58b893
subject: Memory deduplication uses content_hash and occurred_at fields
keywords:
  - deduplication
  - content-hash
  - occurred-at
  - idempotent
  - memory-creation
applies_to: 'file:src/core/memory.ts'
occurred_at: '2025-12-02T01:04:49.159Z'
content_hash: a93a6dffd019f08b
---
# Memory Deduplication Strategy

Local Recall uses two fields to detect and prevent duplicate memories:

1. **occurred_at**: ISO-8601 timestamp of when the original event happened
2. **content_hash**: SHA-256 prefix (16 characters) of the memory content

## Deduplication Logic

The `findDuplicate()` function in memory.ts searches for existing memories with matching `occurred_at` and `content_hash`. If a duplicate is found:
- No new memory is created
- The existing memory ID is returned
- This ensures idempotent behavior even if the same transcript is processed multiple times

## Implications

This means if a transcript is reprocessed (e.g., after editing), memories derived from the same original event with identical content won't create duplicates. However, if content changes, a new memory will be created.
