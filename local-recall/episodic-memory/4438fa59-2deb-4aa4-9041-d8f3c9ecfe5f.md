---
id: 4438fa59-2deb-4aa4-9041-d8f3c9ecfe5f
subject: >-
  Stop hook processes transcripts asynchronously instead of synchronously on
  session end
keywords:
  - stop-hook
  - transcript
  - async
  - background
  - mcp-server
  - memory-extraction
applies_to: 'file:src/hooks/stop.ts'
occurred_at: '2025-12-02T02:01:53.640Z'
content_hash: 49f12f8a4292f92b
---
The Stop hook (src/hooks/stop.ts) is currently disabled in the standard configuration because memory extraction is handled asynchronously by the MCP server instead.

**Why Async Approach**:
- Synchronous processing could delay session end for users
- MCP server daemon runs every 5 minutes to process transcripts
- Allows transcript to finish writing before parsing
- Better for handling large/complex sessions

**Current Flow**:
1. Session ends (Stop hook disabled)
2. MCP daemon checks for new/modified transcripts
3. Processes transcripts using parseTranscriptForMemories()
4. Creates memory files for extracted memories
5. Updates index for search

**If Re-enabling Stop Hook**:
- Would need to handle transcript file I/O carefully
- Should include timeout/error handling
- May impact user experience during session end
