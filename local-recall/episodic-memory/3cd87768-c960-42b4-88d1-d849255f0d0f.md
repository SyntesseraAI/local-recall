---
id: 3cd87768-c960-42b4-88d1-d849255f0d0f
subject: Claude Haiku may return memories as plain array in response
keywords:
  - memory extractor
  - claude response parsing
  - array format
  - validation
  - haiku model
applies_to: 'file:src/core/memory-extractor.ts'
occurred_at: '2025-12-21T19:42:59.391Z'
content_hash: 73e1934818bef8c5
---
The parseClaudeResponse method expected Claude to return `{ memories: [...] }` but Claude (Haiku) sometimes returns a plain array `[...]` directly. Added array detection at lines 174-177 to wrap raw arrays in the expected format before validation: if Array.isArray(parsed), wrap as { memories: parsed }. This handles variable response formats from different Claude models.
