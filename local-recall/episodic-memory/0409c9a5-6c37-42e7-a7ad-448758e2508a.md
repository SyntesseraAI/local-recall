---
id: 0409c9a5-6c37-42e7-a7ad-448758e2508a
subject: Thinking memory extraction now has independent processing in MCP daemon
keywords:
  - thinking extractor
  - daemon
  - parallel
  - separate flags
  - transcript processing
  - mcp server
applies_to: 'file:src/mcp-server/server.ts'
occurred_at: '2025-12-21T18:29:49.579Z'
content_hash: 230c2423b5058410
---
Added thinking memory extraction to the MCP daemon's processing loop. Changes include:

- New imports: `runThinkingExtraction` from `thinking-extractor.js`, `getThinkingVectorStore` from `thinking-vector-store.js`, `ThinkingMemoryManager` from `thinking-memory.js`
- New flag `isThinkingProcessing` to prevent concurrent thinking extraction runs (separate from episodic `isProcessing` flag)
- Thinking extraction now runs in parallel daemon loop alongside episodic extraction
- Each type of memory extraction has its own processing state and can be managed independently

This prevents the SQLite mutex contention that occurred when both hooks tried to run simultaneously as separate processes.
