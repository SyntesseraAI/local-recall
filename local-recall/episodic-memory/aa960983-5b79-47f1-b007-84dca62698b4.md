---
id: aa960983-5b79-47f1-b007-84dca62698b4
subject: >-
  Memory extraction uses Claude Haiku with specific prompt formatting for
  consistent results
keywords:
  - memory-extraction
  - haiku
  - prompt-engineering
  - system-message
  - json-output
  - consistency
applies_to: 'area:memory-extractor'
occurred_at: '2025-12-02T06:32:00.034Z'
content_hash: 830629a696abd11b
---
# Memory Extraction with Claude Haiku

## Model Choice

Uses Claude Haiku (claude-3-5-haiku-20241022) for memory extraction due to:
- Speed and cost efficiency
- Sufficient capability for structured extraction
- Suitable for processing condensed transcripts

## Prompt Structure

The extraction prompt should:
1. Clearly define what constitutes a valuable memory
2. Provide specific examples of good vs. bad memories
3. Include guidelines for scope assignment (global vs. file: vs. area:)
4. Explain keyword selection criteria
5. Request JSON output with strict formatting

## Output Format Requirements

- Must be valid JSON with a `memories` array
- Each memory must have: subject, keywords, applies_to, content
- Subject should be concise (max 200 chars)
- Keywords should be lowercase and specific (1-10 keywords)
- Content should use markdown formatting

## Key Considerations

- System message must guide the model toward extracting only valuable, actionable memories
- The model needs clear examples to avoid extracting generic programming knowledge
- Specific file paths and line numbers are valuable in memory content
- DO NOT directives help prevent extraction of transient debugging info

## Integration with Deduplication

Extracted memories should include:
- `occurred_at`: ISO timestamp when the memory was created
- Content that can be hashed for deduplication
- Scope information to help future sessions find relevant memories
