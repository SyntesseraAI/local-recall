---
id: 2f1c7b7a-91f8-4cd9-8559-c95ac13fe533
subject: >-
  Duplicate event listeners can cause unexpected behavior in Node.js child
  processes
keywords:
  - event listeners
  - child process
  - duplicate handlers
  - close event
  - error handling
applies_to: 'file:src/hooks/user-prompt-submit.ts'
occurred_at: '2025-12-21T19:20:27.934Z'
content_hash: 2a5d9dbf877656ef
---
The user-prompt-submit hook had duplicate `child.on('close', ...)` handlers registered on the same child process. This can cause:
- Multiple callback executions
- Race conditions in promise resolution
- Difficult-to-debug behavior

**Resolution**: Consolidated all event handling into a single `close` handler with proper guards to ensure callbacks execute only once.
