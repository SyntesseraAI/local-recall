---
id: 6b99882f-82b8-4893-9fb7-156c3b2fb338
subject: 'Memory collection refactoring: idempotent create-only pattern'
keywords:
  - memory patterns
  - idempotent
  - deduplication
  - schema changes
applies_to: global
occurred_at: '2025-12-21T19:19:53.624Z'
content_hash: 3009a41639153111
---
Recent refactoring changed memory collection to use an idempotent create-only pattern:

1. **Removed updateMemory**: Memories are never updated, only created or deleted
2. **Removed created_at field**: Memories now only track `occurred_at` (when the original event happened)
3. **Deduplication**: Uses `occurred_at + content_hash` to prevent duplicate memory files
4. **Sorting**: Memories sorted by `occurred_at` for chronological ordering

Branch: `claude/refactor-memory-collection-01HQY8jXfJm7zh35BcYYiE1u`

This simplifies the memory model and makes deduplication deterministic.
