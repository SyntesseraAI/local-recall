---
id: cfd6af54-8dc6-40b0-910b-388583f2c0f2
subject: >-
  Memory extraction uses Zod schema validation with flexible response format
  handling
keywords:
  - zod
  - validation
  - schema
  - json-parsing
  - error-handling
applies_to: 'file:src/core/memory-extractor.ts'
occurred_at: '2025-12-21T18:23:45.023Z'
content_hash: 47d88f37087f5898
---
The parseClaudeResponse method uses Zod for schema validation of memory extraction responses. The schema validates both the overall response structure and individual memory objects. The function must handle various response formats from Claude - the most reliable approach is to first parse the JSON, then normalize the structure before validation. This catches edge cases where the model deviates from the expected format.
