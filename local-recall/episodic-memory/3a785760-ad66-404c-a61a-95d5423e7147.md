---
id: 3a785760-ad66-404c-a61a-95d5423e7147
subject: >-
  Mutex errors caused by onnxruntime-node native bindings in fastembed, not
  sqlite-vec
keywords:
  - mutex
  - fastembed
  - onnxruntime-node
  - native bindings
  - concurrent processes
  - hook architecture
applies_to: global
occurred_at: '2025-12-21T19:22:44.635Z'
content_hash: 291550299e9a4151
---
After migrating to Orama (pure JavaScript vector store), mutex errors were still occurring. Root cause investigation revealed that `fastembed` depends on `onnxruntime-node`, which has native bindings that create the same mutex contention issues as the previous `sqlite-vec` implementation when multiple hook processes load it concurrently. The issue occurs both during initialization and during embedding inference operations.

This is a fundamental problem with loading native modules from multiple CLI hook processes - only one process can hold the mutex lock at a time, causing other processes to fail.
