---
id: d2b7d1ae-4e06-4fd8-ab6f-10c6a8c5b726
subject: Vector store implementation and search scoring
keywords:
  - vector-store
  - sqlite-vec
  - embedding
  - fastembed
  - cosine-distance
  - scoring
applies_to: 'area:vector-store'
occurred_at: '2025-12-02T16:25:21.582Z'
content_hash: 204a84af48804b09
---
Vector store uses better-sqlite3 with sqlite-vec extension for semantic similarity search:

- **Embeddings**: Generated using fastembed library with BGE-small-en-v1.5 model (~133MB), cached in `local_cache/`
- **Similarity Scoring**: Uses cosine distance (range 0.0 to 1.0, rounded to 2 decimal places)
- **Ranking**: Results sorted by score descending
- **Tie-breaker**: When scores equal, more recent memories (by occurred_at) rank first
- **Sync Method**: `sync(memories)` reconciles file-based memories with vector store (add/remove as needed)

First startup downloads model and may take 30-60 seconds. Subsequent runs load from cache. Model cache corruption can cause 'Tokenizer file not found' error - fix by removing `local_cache/fast-bge-small-en-v1.5*`.
