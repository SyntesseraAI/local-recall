---
id: 0c3444da-1903-4c45-85b0-470ff8a27088
subject: UserPromptSubmit hook timeout misconfiguration causing AbortError
keywords:
  - hook
  - timeout
  - abort
  - error-handling
  - user-prompt-submit
applies_to: 'file:src/hooks/user-prompt-submit.ts'
occurred_at: '2025-12-21T19:32:21.797Z'
content_hash: 4013bd9a29b97782
---
The UserPromptSubmit hook had a 30-second timeout configured in `dev-marketplace/local-recall-plugin/config/hooks.json`, but the internal Claude CLI call also had a 30-second timeout. When the hook timeout fired first, it would abort the child process, triggering an unhandled `AbortError: The operation was aborted`.

Fixes applied:
1. Increased hook timeout from 30s to 45s
2. Reduced internal Claude CLI timeout to 20s (less than hook timeout)
3. Added proper abort error handling with try-catch around spawn
4. Fixed stdin piping issue (see related memory)

The hook now handles timeouts gracefully and completes in 2-3 seconds instead of timing out.
