---
id: f498444e-672e-4fce-8895-624ad3881252
subject: Transcript reprocessing flow uses content hash for idempotency
keywords:
  - transcript processing
  - content hash
  - idempotent
  - memory lifecycle
  - deduplication
applies_to: global
occurred_at: '2025-12-21T19:28:17.398Z'
content_hash: 83b1348851df37ae
---
The transcript processing pipeline ensures idempotency through content hashing:

1. **Sync step** (`syncTranscripts`): Copies transcripts from Claude cache to local storage, checks mtime/size for changes
2. **Process step** (`processTranscript`): Computes SHA-256 content hash of the transcript
3. **Deduplication** (`ProcessedLog.has`): Checks if transcript with this hash was already processed
4. **Cleanup**: If hash differs from previous run, old memories (tracked by `transcriptId`) are deleted
5. **Creation**: New memories created for the current transcript

This approach handles the case where transcripts are modified, ensuring memories stay in sync with transcript content without manual intervention.
