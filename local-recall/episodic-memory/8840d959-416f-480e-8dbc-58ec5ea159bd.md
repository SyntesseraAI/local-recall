---
id: 8840d959-416f-480e-8dbc-58ec5ea159bd
subject: >-
  Memory extraction system uses Claude API with streaming and conditional memory
  creation
keywords:
  - memory-extractor
  - claude-api
  - streaming
  - conditional-creation
  - transcript-processing
applies_to: 'file:src/core/memory-extractor.ts'
occurred_at: '2025-12-01T16:34:50.067Z'
content_hash: 519eb45aca5b5159
---
The memory-extractor module processes transcripts using the Claude API with streaming. It conditionally creates memories only when the LLM output contains valid YAML frontmatter (starting with '---'). The extraction uses a prompt template from memory-extraction.ts and includes error handling for streaming interruptions. Key implementation details:

- Uses `Anthropic` client with streaming enabled
- Parses streaming response for YAML frontmatter delimiter
- Only creates memory if valid frontmatter is detected
- Handles edge cases like streaming errors and empty responses
- Returns structured memory objects with metadata

This pattern ensures memories are only persisted when the LLM produces valid, well-formed output.
