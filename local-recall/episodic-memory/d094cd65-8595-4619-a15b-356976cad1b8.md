---
id: d094cd65-8595-4619-a15b-356976cad1b8
subject: >-
  Memory deduplication only occurs at creation time, not during compaction or
  cleanup
keywords:
  - memory
  - deduplication
  - duplicate prevention
  - createMemory
  - findDuplicate
  - content_hash
applies_to: 'file:src/core/memory.ts'
occurred_at: '2025-12-01T15:55:34.707Z'
content_hash: c7997aec1f063b5f
---
## Memory Deduplication Strategy

Local Recall uses a **create-time deduplication** approach:

### How It Works

1. When `createMemory()` is called, it checks for existing duplicates using `findDuplicate()`
2. Duplicate detection compares:
   - `occurred_at` timestamp
   - `content_hash` (SHA-256 prefix)
3. If a duplicate is found, the existing memory is returned instead of creating a new one
4. This prevents accidental duplicate memories from the same event

### No Ongoing Compaction

- There is no scheduled memory compaction process
- There is no cleanup of outdated or superseded memories
- Memories accumulate over time and must be manually deleted if needed
- The MCP server's background daemon processes transcripts every 5 minutes but doesn't compact memories

### Implications

- Memory index can grow indefinitely without cleanup
- Old memories remain searchable even if newer versions exist
- Manual intervention is needed if memories become stale or redundant
- This is appropriate for episodic memories (recording what happened), but requires user discipline for maintenance
