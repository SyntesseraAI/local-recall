---
id: 1f31c421-2f1b-492b-85b0-f8e4a7a90ff7
subject: Multiple local-recall instances in same folder have concurrent write conflicts
keywords:
  - concurrency
  - multi-instance
  - orama-index
  - processed-log
  - file-locking
applies_to: global
occurred_at: '2025-12-21T18:23:54.705Z'
content_hash: c2b183a9c364edfd
---
When multiple Claude Code instances run local-recall on the same codebase folder, they cause concurrent write conflicts:

- `orama-episodic-index.json` and `orama-thinking-index.json`: Multiple processes write without locking, corrupting JSON
- `local-recall/thinking-processed-log.jsonl` and `local-recall/episodic-processed-log.jsonl`: Concurrent appends cause corruption
- `local-recall/thinking-memory/` and `local-recall/episodic-memory/`: File creations race and overwrite

Solution: Implement file-based locking (e.g., `proper-lockfile` or `fs.promises.open` with exclusive flags) before write operations. Need to handle:
1. Lock acquisition with timeout
2. Graceful degradation if lock fails
3. Cleanup of stale locks
4. Atomic writes to prevent partial file corruption
