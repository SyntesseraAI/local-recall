---
id: 51e2ee0d-95b4-4ba9-b8bb-afd65ee40d89
subject: Memory deduplication uses occurred_at and content_hash
keywords:
  - deduplication
  - duplicate
  - content-hash
  - occurred-at
  - idempotent
  - memory
applies_to: 'file:src/core/memory.ts'
occurred_at: '2025-12-02T16:59:26.008Z'
content_hash: c1ae08ca4549f2db
---
# Memory Deduplication Strategy

## How Duplicates Are Detected

Memories are idempotent and duplicates are detected using two fields:

1. **occurred_at**: ISO-8601 timestamp of when the event occurred
2. **content_hash**: SHA-256 hash prefix (16 characters) of the memory content

Both fields together form a composite key for deduplication.

## Implementation

The `findDuplicate(occurredAt, contentHash)` method in `MemoryManager` checks if a memory with the same `occurred_at` + `content_hash` combination already exists.

## Why This Works

- `occurred_at` ensures we're looking at the same event in time
- `content_hash` ensures the content is identical
- Together they prevent storing the exact same memory twice
- If a transcript is re-processed with different extracted memories, old ones are deleted first

This allows safe re-processing of transcripts without accumulating duplicate memories.
