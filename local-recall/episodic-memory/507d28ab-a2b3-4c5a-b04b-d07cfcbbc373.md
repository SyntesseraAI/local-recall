---
id: 507d28ab-a2b3-4c5a-b04b-d07cfcbbc373
subject: Memory extraction must handle both thinking and multiline content correctly
keywords:
  - thinking blocks
  - memory extraction
  - single-line content
  - transcript analysis
applies_to: 'file:src/utils/transcript.ts'
occurred_at: '2025-12-21T18:24:55.963Z'
content_hash: 4f029798abca2840
---
The `analyzeForMemories()` function has specific rules for what gets saved as memories:

1. **Thinking**: Save ALL thinking content (even single-line), prefixed with "[Thinking]"
2. **Content/Answers**: Only save MULTILINE content - single-line responses are dropped
3. **User messages**: Never save user messages, only assistant messages

This filtering happens in `analyzeForMemories()` (lines 294-342) which checks `lines.length >= 2` for content. The `parseTranscriptForMemories()` function calls this after parsing raw JSONL, ensuring consistent behavior.
