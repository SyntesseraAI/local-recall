---
id: 1a173518-30d3-4aba-bce8-61565bb46bae
subject: Memory extractor must handle raw array responses from Claude
keywords:
  - memory-extractor
  - claude-response
  - parsing
  - array-format
  - error-handling
applies_to: 'file:src/core/memory-extractor.ts'
occurred_at: '2025-12-02T01:13:41.039Z'
content_hash: 2b180b4966195734
---
The memory extractor's `parseClaudeResponse` method at line 174 expects Claude to return `{ memories: [...] }` but Claude (Haiku) sometimes returns a plain array `[...]` directly. This causes JSON parsing to fail when trying to access `.memories` on an array. Fix: Check if response is an array before attempting property access. Pattern: `Array.isArray(response) ? response : response.memories`
