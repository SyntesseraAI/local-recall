---
id: 66bbf9a9-33b6-41b4-992b-9e8591f0742a
subject: >-
  Memory extraction uses semantic similarity with embedding model, not just
  keywords
keywords:
  - memory-extraction
  - embedding
  - semantic
  - similarity
  - fastembed
  - bge-model
  - vector-store
  - mcp-daemon
applies_to: 'area:memory-extraction'
occurred_at: '2025-12-01T23:05:48.192Z'
content_hash: 3727bf8b91b79962
---
# Memory Extraction with Semantic Similarity

The MCP daemon's memory extraction process uses semantic similarity based on embeddings, not keyword matching.

## Implementation Details

- Uses the `fastembed` library with BGE-small-en-v1.5 model for embeddings
- The model files are cached in `local_cache/` directory (~133MB)
- A vector store is maintained to compare transcript segments with existing memories
- Similarity matching determines whether a new memory should be created or if a similar memory already exists

## Technical Approach

1. Extract segments from the transcript
2. Generate embeddings for each segment using the BGE model
3. Compare embeddings against existing memory embeddings using vector similarity
4. Create new memories only if no sufficiently similar memory exists
5. Use content_hash as a secondary deduplication check

## Performance Consideration

First run downloads the embedding model (~133MB), which can take 30-60 seconds. Subsequent runs use the cached model and are much faster.

## Files Involved

- `src/core/embedding.ts` - Embedding generation
- `src/core/vector-store.ts` - Vector storage and similarity search
- Background daemon in MCP server processes transcripts asynchronously
