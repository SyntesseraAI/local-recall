---
id: 2bbc1946-3f68-496d-aa96-9506030c4b62
subject: sqlite-vec requires LIMIT k constraint in vector search JOIN queries
keywords:
  - sqlite-vec
  - vector-search
  - sql
  - limit
  - join
  - constraint
applies_to: 'file:src/core/vector-store.ts'
occurred_at: '2025-12-21T19:14:59.526Z'
content_hash: 52740159a7b55fc3
---
The sqlite-vec extension requires `k = ?` in the match clause for JOIN queries to work correctly. When searching with scope filters, must request k+filter_buffer results from sqlite-vec, then filter in JavaScript after retrieval. Cannot apply WHERE scope filter before the k LIMIT in SQL.
