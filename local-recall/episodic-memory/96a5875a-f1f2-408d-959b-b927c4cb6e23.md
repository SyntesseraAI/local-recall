---
id: 96a5875a-f1f2-408d-959b-b927c4cb6e23
subject: >-
  Memory extraction from transcripts should be done by transcript collector
  daemon
keywords:
  - memory-extraction
  - transcripts
  - daemon
  - background-process
  - mcp-server
  - async
applies_to: global
occurred_at: '2025-12-01T16:28:26.035Z'
content_hash: bdfa5164f091f5e0
---
# Memory Extraction Architecture

## Design Principle

Memory extraction should be handled asynchronously by the MCP server daemon rather than in the Stop hook, to avoid blocking the Claude Code user.

## Current Implementation

The `src/core/transcript-collector.ts` module implements background memory extraction:
- Syncs transcripts from Claude's cache (`~/.claude/projects/<project>/transcripts/`)
- Processes transcripts on a periodic schedule (every 5 minutes by default)
- Uses content hashing to detect transcript changes
- Creates or updates memories based on extracted information

## Benefits

- **Non-blocking**: User isn't delayed waiting for memory extraction
- **Reliable**: Persisted task state allows recovery from failures
- **Efficient**: Batch processing and change detection minimize redundant work
- **Flexible**: Can be tuned for different polling intervals and batch sizes
