---
id: 6298a549-4444-43dd-b100-e5808ebbfef6
subject: Memory extractor must handle raw array responses from Claude
keywords:
  - memory-extractor
  - claude-response
  - parsing
  - array-format
  - error-handling
applies_to: 'file:src/core/memory-extractor.ts'
occurred_at: '2025-12-01T16:24:06.313Z'
content_hash: a799897454bd0e08
---
The memory extractor's `parseClaudeResponse` method at line 174 expects Claude to return `{ memories: [...] }` but Claude (Haiku) sometimes returns a plain array `[...]` directly. Fixed by adding array detection that wraps raw arrays in the expected format before schema validation. This handles the case where Claude returns an array of memory objects directly instead of wrapping them in an object.
