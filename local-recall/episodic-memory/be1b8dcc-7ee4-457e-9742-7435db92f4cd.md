---
id: be1b8dcc-7ee4-457e-9742-7435db92f4cd
subject: >-
  Memory extractor parseClaudeResponse must handle Claude returning memories as
  plain array
keywords:
  - memory-extractor
  - parsing
  - claude-response
  - array-handling
  - zod-validation
applies_to: 'file:src/core/memory-extractor.ts'
occurred_at: '2025-12-21T18:23:45.023Z'
content_hash: 6577d927381b3e75
---
The `parseClaudeResponse` function in memory-extractor.ts expected Claude to always return `{ memories: [...] }` format, but Claude Haiku sometimes returns a plain array `[{...}, {...}]` directly. Fixed by adding array detection at line 174-177 that wraps raw arrays in the expected format before Zod validation. This prevents 'Expected object, received array' errors during memory extraction.
