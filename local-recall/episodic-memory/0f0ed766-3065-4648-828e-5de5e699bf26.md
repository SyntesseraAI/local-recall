---
id: 0f0ed766-3065-4648-828e-5de5e699bf26
subject: >-
  Memory extraction uses Claude Haiku with structured prompting for keyword and
  memory generation
keywords:
  - memory-extractor
  - claude-haiku
  - keyword-extraction
  - memory-generation
  - structured-prompts
applies_to: 'file:src/core/memory-extractor.ts'
occurred_at: '2025-12-01T22:43:46.579Z'
content_hash: 4ac7b6e872cd777c
---
The memory extraction system uses Claude Haiku (claude-3-5-haiku-20241022) to process transcripts and extract memories. It employs two structured prompts:

1. **Keyword Extraction**: Analyzes transcript content to identify relevant keywords for memory indexing
2. **Memory Generation**: Creates actual memory objects with metadata (id, subject, keywords, applies_to, occurred_at, content_hash)

The extraction process:
- Condenses transcripts to reduce token usage
- Sends condensed transcript to Haiku for analysis
- Receives structured JSON response with memory data
- Validates and deduplicates memories before storage

Key design decisions:
- Uses Haiku for cost efficiency (not Sonnet)
- Deduplicates by checking content_hash against existing memories
- Stores occurred_at timestamp for temporal ordering
- Marks scope as `global`, `file:<path>`, or `area:<name>`
