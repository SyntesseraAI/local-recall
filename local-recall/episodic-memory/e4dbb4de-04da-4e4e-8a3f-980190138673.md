---
id: e4dbb4de-04da-4e4e-8a3f-980190138673
subject: >-
  UserPromptSubmit hook performs semantic search using vector store after lazy
  initialization
keywords:
  - user-prompt-submit
  - hook
  - semantic search
  - vector store
  - lazy initialization
applies_to: 'file:src/hooks/user-prompt-submit.ts'
occurred_at: '2025-12-02T12:02:47.591Z'
content_hash: fadac5e266d53c36
---
The UserPromptSubmit hook is triggered before Claude processes user input:
1. Receives JSON input: session_id, transcript_path, cwd, prompt
2. Initializes vector store on first use (lazy initialization, cached after first use)
3. Performs semantic search using vector embeddings
4. Outputs matching memories to stdout (injected into Claude's context)

This allows context-aware memory retrieval based on the actual user query rather than just recent memories.
