---
id: 2a609da0-6f4f-4534-95b7-255f46d41443
subject: 'MCP server daemon: JSONL-aware syncing and auto-compaction'
keywords:
  - mcp
  - daemon
  - sync
  - compaction
  - transcript
applies_to: 'file:src/mcp-server/server.ts'
occurred_at: '2025-12-21T19:03:33.302Z'
content_hash: 384d3b61f6204e86
---
Updated MCP server daemon's `runVectorSync()` to use `syncWithJsonlStore()` instead of direct file sync. After syncing, checks if JSONL files exceed size threshold and triggers auto-compaction. Auto-compaction runs every 5 minutes if needed, removing deleted entries and creating clean files. Migration runs on startup via `migrate()` function to convert any existing markdown memories to JSONL format.
