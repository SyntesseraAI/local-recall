---
id: 19da58a6-8d5f-439f-8650-8f18a0ed1c0b
subject: 'Memory extraction criteria: save all thinking, but only multiline content'
keywords:
  - memory
  - extraction
  - thinking
  - content
  - multiline
  - filter
applies_to: 'file:src/utils/transcript.ts'
occurred_at: '2025-12-21T18:26:21.981Z'
content_hash: 14dfe11a460cc714
---
The `analyzeForMemories()` function implements this filtering logic:
- **All thinking**: Save all assistant thinking blocks (even single-line) - prefixed with '[Thinking]' in subject
- **Content**: Only save multiline assistant content (2+ non-empty lines)
- **User messages**: Never saved

This is implemented in `src/utils/transcript.ts:294-342` using `message.thinking?.trim()` check and `lines.length >= 2` filter.
