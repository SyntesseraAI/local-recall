---
id: e200f3e7-a3b4-4f95-8c38-f6d193ac687e
subject: >-
  UserPromptSubmit hook uses lazy initialization and caching for vector store
  performance
keywords:
  - userpromptsubmit-hook
  - semantic-search
  - vector-store
  - lazy-loading
applies_to: 'file:src/hooks/user-prompt-submit.ts'
occurred_at: '2025-12-02T16:19:51.746Z'
content_hash: 374ed23fb91ec91a
---
The UserPromptSubmit hook is optimized for performance:

- Initializes the vector store lazily (only when needed)
- Caches the vector store after first use to avoid re-initialization
- Performs semantic search using vector embeddings on the user prompt
- Outputs matching memories to stdout for injection into Claude's context
- Triggered when a user submits a prompt, before Claude processes it

This design allows semantic search without the startup cost on every session.
