---
id: 16a72fad-dc1f-41f4-8e0c-e870e40c5aca
subject: Mutex errors occur when multiple processes load sqlite-vec concurrently
keywords:
  - mutex
  - sqlite-vec
  - concurrent processes
  - locking
  - file-based locking
  - error handling
applies_to: global
occurred_at: '2025-12-21T19:18:27.194Z'
content_hash: f4ccfe3f1a2f3781
---
The codebase has identified a critical issue where loading sqlite-vec from multiple processes concurrently can cause 'mutex lock failed: Invalid argument' errors. The solution involves using cross-process file locking to prevent simultaneous sqlite-vec initialization. This is implemented in src/mcp-server/server.ts:230. Tests for mutex/concurrent behavior do not currently exist (no files found matching tests/**/*mutex* or tests/**/*concurrent*), suggesting this is an area needing test coverage.
