---
id: 5d2d9e4f-a3a7-476f-b4c9-a837808aa259
subject: Memory extractor handles multiple Claude response wrapper formats
keywords:
  - memory-extractor
  - json-parsing
  - claude-response
  - wrapper-formats
  - fallback-logic
applies_to: 'file:src/core/memory-extractor.ts'
occurred_at: '2025-12-21T18:19:47.354Z'
content_hash: 1da7d09b10a9ffd5
---
The `parseClaudeResponse` function in memory-extractor.ts handles multiple JSON wrapper formats that Claude might return:

1. Direct array: `[{memory1}, {memory2}]`
2. `memories` wrapper: `{memories: [{...}, {...}]}`
3. `results` wrapper: `{results: [{...}]}`
4. Fallback: Extract JSON object from response text using regex

Each format is tried in sequence with the wrapper checks before attempting the fallback regex extraction. Field normalization is applied to all parsed objects regardless of source format.
