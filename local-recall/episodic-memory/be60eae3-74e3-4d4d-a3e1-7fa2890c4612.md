---
id: be60eae3-74e3-4d4d-a3e1-7fa2890c4612
subject: UserPromptSubmit hook unifies episodic and thinking memory search
keywords:
  - UserPromptSubmit
  - semantic search
  - episodic
  - thinking
  - unified
  - Orama
applies_to: 'file:src/hooks/user-prompt-submit.ts'
occurred_at: '2025-12-21T18:59:30.332Z'
content_hash: e83f302cf326563e
---
The UserPromptSubmit hook implements a unified search strategy:
1. Searches both episodic and thinking memories based on configuration flags
2. Uses Orama vector store + Ollama embeddings for semantic similarity
3. Filters by minimum similarity threshold (default 0.5)
4. Respects token budgets for each memory type
5. Skips internal prompts containing `[LOCAL_RECALL_INTERNAL]`
6. Outputs combined results to stdout

Each memory type has independent configuration for enabled/disabled, max tokens, and min similarity.
