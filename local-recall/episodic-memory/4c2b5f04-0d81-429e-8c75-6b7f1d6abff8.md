---
id: 4c2b5f04-0d81-429e-8c75-6b7f1d6abff8
subject: >-
  Memory system redesigned to use episodic immutable architecture with
  idempotent deduplication
keywords:
  - architecture
  - memory model
  - episodic
  - idempotent
  - deduplication
  - immutable
applies_to: global
occurred_at: '2025-12-01T16:17:37.027Z'
content_hash: a16b2d9007f54a71
---
# Episodic Memory Architecture Decision

The memory system was redesigned to store memories as an immutable episodic log rather than a mutable knowledge base.

## Key Changes

### Deduplication Strategy
- Each memory includes `occurred_at` (when event happened), `created_at` (when memory was written), and `content_hash` (SHA-256 prefix)
- Deduplication key is `occurred_at` + `content_hash`
- This prevents duplicate memories from being created while allowing the same content to be remembered at different times

### Immutability
- Removed `memory_update` and `memory_delete` MCP tools
- Memories can only be created or deleted by the user manually
- This aligns with how human episodic memory works - events are recorded, not revised

### Stop Hook Processing
- Changed from 30-second time window filtering to processing entire conversation history
- All messages in transcript are now analyzed for memory extraction
- Prevents loss of important context just because enough time has passed

## Reasoning
This approach treats memories as immutable event logs that can be deduplicated based on content and timing, making them more like actual episodic memory and reducing the complexity of mutable operations.
