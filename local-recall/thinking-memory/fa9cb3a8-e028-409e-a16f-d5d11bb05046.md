---
id: fa9cb3a8-e028-409e-a16f-d5d11bb05046
subject: 'I''ve completed the rate limit handling feature. Let me provide a summary:'
applies_to: global
occurred_at: '2025-12-01T18:12:34.758Z'
content_hash: af3b1352688523c1
---
## Thought

I've completed the rate limit handling feature. Let me provide a summary:

## Output

## Summary

I've implemented rate limit detection and handling in the memory extractor. Here's what was added:

### Changes to `src/core/memory-extractor.ts`

1. **`RateLimitError` class** - Custom error with `resetTime` property for rate limit handling

2. **`parseRateLimitResetTime()`** - Parses reset time from Claude CLI messages:
   - Handles "resets 11:30 PM" (absolute time with AM/PM)
   - Handles "resets in 2 hours" (relative time)
   - Handles "resets in 30 minutes" (relative time)

3. **`checkForRateLimit()`** - Detects rate limit patterns in responses:
   - `5-hour limit reached`
   - `rate limit`
   - `too many requests`
   - `quota exceeded`

4. **Updated `callClaudeCLI()`** - Checks response for rate limits before resolving

5. **Updated `callClaudeCLIWithRetry()`** - Does NOT retry on rate limit errors (throws immediately)

6. **Updated `processAllTranscripts()`** - Handles rate limits by:
   - Stopping current batch when rate limit hit
   - NOT marking the rate-limited transcript as processed
   - Waiting until reset time + 5 minutes
   - Resuming processing of remaining transcripts

### New Tests (14 tests added)
- `parseRateLimitResetTime` - 7 tests for time parsing
- `checkForRateLimit` - 7 tests for error detection
