---
id: 6ff47978-76dd-4a7d-9706-427a08b0b47f
subject: >-
  The SQL queries have LIMIT clauses, so that should be fine. The issue is that
  sqlite-vec requires a...
applies_to: global
occurred_at: '2025-12-01T20:22:40.631Z'
content_hash: ba207f2de6e619df
---
## Thought

The SQL queries have LIMIT clauses, so that should be fine. The issue is that sqlite-vec requires a specific constraint format for knn queries. Looking at the error "A LIMIT or 'k = ?' constraint is required on vec0 knn queries", it seems like sqlite-vec might need the `k = ?` parameter in the MATCH clause rather than as a LIMIT.Let me check the sqlite-vec documentation/syntax. The `embedding MATCH` is the knn query, and it needs either:
1. A `k = ?` parameter in the match
2. A LIMIT clauseThe LIMIT clause is being used in my queries. The issue might be that the sqlite-vec extension doesn't recognize LIMIT in a JOIN scenario. Let me check if there's a specific syntax needed.

Looking at the sqlite-vec documentation, the knn query needs the limit passed as part of the match or query. Let me update the SQL to use the `k = ?` syntax instead:

The vec0 virtual table needs the k parameter specified using `vec0_rowid_match` or the `LIMIT` must be directly on the virtual table query. With joins, it may not work. Let me update the query format.

Actually, looking at the sqlite-vec docs, for a JOIN query, you need to use a subquery or the k constraint. Let me try fixing the SQL by using a different approach - doing the knn search in a subquery:

## Output

The sqlite-vec extension requires `k = ?` in the match clause for JOIN queries. Let me fix the vector store search:
