---
id: 09a8d442-1be3-4c96-9a46-85e82c9387e8
subject: >-
  I see the issue now. Looking at `http-server.ts`: 1. The
  `handleEpisodicSearch` function creates a...
applies_to: global
occurred_at: '2025-12-03T10:01:57.414Z'
content_hash: ab153cf9be916b53
---
## Thought

I see the issue now. Looking at `http-server.ts`:

1. The `handleEpisodicSearch` function creates a new `SearchEngine` if one doesn't exist
2. The `handleThinkingSearch` function creates a new `ThinkingSearchEngine` if one doesn't exist

Both of these search engines use sqlite-vec and have their own vector stores. The problem might be:

1. When episodic search and thinking search are both called, they could be running concurrently and both trying to access the database at the same time
2. Both `SearchEngine` and `ThinkingSearchEngine` may be initializing their vector stores at similar times

Let me look at both search engines to understand how they handle the database access.

## Output

I see the issue. The HTTP server creates separate `SearchEngine` and `ThinkingSearchEngine` instances that each manage their own vector stores. Let me check if they share the same database connection or create separate ones.
