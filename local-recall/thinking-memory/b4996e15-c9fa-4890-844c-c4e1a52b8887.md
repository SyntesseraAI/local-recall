---
id: b4996e15-c9fa-4890-844c-c4e1a52b8887
subject: >-
  Both changes have been made and the build is successful. Let me summarize what
  I fixed: 1....
applies_to: global
occurred_at: '2025-11-30T15:00:38.272Z'
content_hash: 09a0796b82c82faa
---
Both changes have been made and the build is successful. Let me summarize what I fixed:

1. **Session guarding fix**: Added `[LOCAL_RECALL_INTERNAL]` prefix to the memory extraction prompt in `src/prompts/memory-extraction.ts`. Now when the MCP server daemon calls `claude -p` with the memory extraction prompt, the UserPromptSubmit hook will detect the prefix and skip processing, preventing recursion.

2. **Timeout increase**: Changed the timeout in `src/core/memory-extractor.ts` from 120000ms (2 minutes) to 600000ms (10 minutes) to allow more time for memory extraction.

3. **Test update**: Added a test to verify the `[LOCAL_RECALL_INTERNAL]` prefix is present to prevent regression.
