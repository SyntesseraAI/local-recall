---
id: ea85db45-5387-42a8-8890-f99f84dbbf5a
subject: >-
  I need to add an async mutex to serialize database operations within the same
  process. The...
applies_to: global
occurred_at: '2025-12-03T10:04:02.903Z'
content_hash: 4bec2469be032dff
---
## Thought

I need to add an async mutex to serialize database operations within the same process. The file-based lock only protects the `sqliteVec.load()` call but not the subsequent database operations.

I'll add an in-process async mutex that all database operations must acquire before doing anything with sqlite-vec. This will prevent concurrent database operations within the daemon process.

## Output

I'll add an in-process async mutex to serialize all database operations. The file-based lock only protects the `sqliteVec.load()` call, but concurrent operations after loading still cause mutex issues.
