---
id: aff39669-fd07-4d3b-b43c-d0f977d7f3aa
subject: >-
  I see. The config loads from `process.cwd()` and the `LOCAL_RECALL_DIR`
  environment variable gives...
applies_to: global
occurred_at: '2025-11-30T14:48:34.728Z'
content_hash: 74ac66f4361dc4bb
---
I see. The config loads from `process.cwd()` and the `LOCAL_RECALL_DIR` environment variable gives the memory directory path. But the project path (needed to find the Claude project folder) isn't explicitly configured.

The issue is that:
1. The MCP server uses `process.cwd()` as the project path (default in MemoryExtractor)
2. But `LOCAL_RECALL_DIR` might be relative like `./local-recall`
3. When `LOCAL_RECALL_DIR` is relative, it's relative to `process.cwd()`

So if `LOCAL_RECALL_DIR` is `./local-recall`, then `process.cwd()` should be the project directory. But maybe it's not? Let me think...

Actually, the MCP server is started by Claude Code with the environment variable. The cwd should be the project directory. Let me check what the actual cwd is when the MCP server runs.

Wait, looking at the log output the user shared:
```
[2025-11-30T14:45:15.080Z] [WARN] [transcript] Could not find matching Claude project directory
```

This happens even after my changes. The issue is that the code I changed hasn't been rebuilt yet! The daemon is running the old code. Let me rebuild and verify.

Actually, the build was successful. But the MCP server that's running might be the old version. The daemon runs continuously, so it might need to be restarted.

But wait, there's another issue. Let me trace through the logic:

1. MCP server starts with `LOCAL_RECALL_DIR=./local-recall`
2. `process.cwd()` should be the project directory
3. `MemoryExtractor` is created with `projectPath = process.cwd()`
4. `TranscriptCollector` is created with that projectPath
5. `pathToClaudeFolderName()` converts it to `-Users-joe-Code-Syntessera-local-recall`


6. We look for that folder in `~/.claude/projects/`

I'll investigate the potential discrepancy in the current working directory. The path resolution seems complex, and I need to verify exactly how `process.cwd()` is being determined when the MCP server launches. Adding debug logging will help pinpoint where the project path detection might be failing.
