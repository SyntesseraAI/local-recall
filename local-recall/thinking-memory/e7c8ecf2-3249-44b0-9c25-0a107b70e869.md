---
id: e7c8ecf2-3249-44b0-9c25-0a107b70e869
subject: >-
  The user wants me to extract memories from this transcript. This is a
  [LOCAL_RECALL_INTERNAL]...
applies_to: global
occurred_at: '2025-12-21T18:16:38.444Z'
content_hash: 63013cec17d2bab9
---
## Thought

The user wants me to extract memories from this transcript. This is a [LOCAL_RECALL_INTERNAL] analysis of what was learned during the session.

Let me analyze what happened:

1. **Problem Discovery**: The MCP server was failing to start, and through investigation, they discovered the root cause was that the `scripts/` directory (containing the MCP server) wasn't being included when Claude Code cached the plugin from GitHub.

2. **Root Cause Analysis**: 
   - The `scripts/` directory was gitignored (specifically `scripts/` and `local-recall-plugin/scripts/`)
   - Claude Code fetches plugins from Git repos, so only committed files are available
   - The MCP server script (`local-recall-plugin/scripts/mcp-server/server.js`) wasn't in Git, so it wasn't available when Claude Code cached the plugin

3. **Solution Applied**:
   - Updated `.gitignore` to change `scripts/` to `/scripts/` (only ignore root level)
   - Added negation pattern `!local-recall-plugin/scripts/` to explicitly include plugin scripts
   - Committed and pushed the changes

4. **Key Learning**: 
   - Claude Code plugins that have MCP servers or other distributed files need those files committed to Git
   - The `.gitignore` needs to be carefully structured to exclude build artifacts but include distribution files
   - Plugin scripts must be in the plugin cache for Claude Code to use them

Let me extract valuable memories:

1. A memory about the plugin distribution issue - specifically that Claude Code fetches from Git and gitignore matters
2. A memory about the `.gitignore` fix pattern - changing `scripts/` to `/scripts/` and using negation
3. A memory about debugging MCP server startup issues - the approach used here
4. A memory about the specific plugin file structure and what needs to be committed

Let me create comprehensive memories:

**Memory 1**: About plugin distribution and gitignore
- Subject: Claude Code plugins must track distribution files in Git, gitignore affects caching


- Keywords: plugin, git, gitignore, mcp, distribution, claude-code, cache
- Applies to: global (this is a fundamental issue with how Claude Code plugins work)
- Content: Claude Code retrieves plugins exclusively from committed Git repository files. Careful gitignore configuration is crucial to ensure essential distribution files like MCP server scripts remain accessible during plugin caching.

**Memory 2**: About the specific gitignore fix
- Subject: .gitignore pattern to exclude root scripts but include plugin scripts
- Keywords: gitignore, scripts, plugin, negation pattern, local-recall-plugin
- Applies to: file:.gitignore
- Content: Modify gitignore to use `/scripts/` for root-level exclusion and add `!local-recall-plugin/scripts/` as a negation pattern, ensuring specific plugin scripts remain tracked and available.

I'll complete the partial thought from the previous thinking by copying over the next thinking: from `scripts/` to `/scripts/` and adding `!local-recall-plugin/scripts/` to allow plugin distribution files

The gitignore modification ensures precise control over script visibility, preventing unintended exclusion of critical plugin components while maintaining a clean repository structure.

## Output

```json
{
  "memories": [
    {
      "subject": "Claude Code plugins fetch from Git - distribution files must be committed and tracked",
      "keywords": [
        "claude-code",
        "plugin",
        "git",
        "gitignore",
        "distribution",
        "cache",
        "mcp"
      ],
      "applies_to": "global",
      "content": "Claude Code fetches plugins from Git repositories (e.g., GitHub) and caches them locally. Only files that are committed to Git make it into the plugin cache. This means scripts, MCP server files, and other distribution files must be explicitly tracked in Git - they cannot be gitignored. If a plugin's MCP server or other critical files are missing from the cache, first check if they're being excluded by `.gitignore`."
    },
    {
      "subject": ".gitignore fix: Change scripts/ to /scripts/ and use negation for plugin scripts",
      "keywords": [
        "gitignore",
        "scripts",
        "negation",
        "plugin",
        "pattern"
      ],
      "applies_to": "file:.gitignore",
      "content": "To exclude build output scripts while including plugin distribution scripts:\n- Change `scripts/` to `/scripts/` (restricts to root level only)\n- Add `!local-recall-plugin/scripts/` (negation pattern to explicitly include)\n\nThis prevents the root-level scripts directory (build output) from being tracked while allowing `local-recall-plugin/scripts/` (which contains distributed MCP server files) to be committed to Git."
    },
    {
      "subject": "MCP server startup failure in Claude Code plugins - check plugin cache",
      "keywords": [
        "mcp",
        "server",
        "startup",
        "error",
        "debugging",
        "plugin",
        "cache",
        "git"
      ],
      "applies_to": "area:mcp-server",
      "content": "When an MCP server fails to start in a Claude Code plugin:\n1. Check if the server script exists in the plugin cache: `~/.claude/plugins/cache/[marketplace-name]/[plugin-name]/[version]/scripts/`\n2. If missing, verify the script is committed to Git (check `.gitignore` exclusions)\n3. Update the plugin cache with `/plugin update [plugin-name]` or restart Claude Code\n4. The issue is usually that distribution files weren't committed to Git due to overly broad gitignore patterns"
    },
    {
      "subject": "local-recall-plugin structure: scripts/ directory must be tracked for MCP distribution",
      "keywords": [
        "local-recall-plugin",
        "scripts",
        "mcp-server",
        "distribution",
        ".mcp.json"
      ],
      "applies_to": "file:local-recall-plugin/.mcp.json",
      "content": "The `.mcp.json` manifest references `${CLAUDE_PLUGIN_ROOT}/scripts/mcp-server/server.js`. For the plugin to work in Claude Code:\n- The `local-recall-plugin/scripts/` directory must exist and be committed to Git\n- `.gitignore` must not exclude `local-recall-plugin/scripts/`\n- When Claude Code downloads the plugin from GitHub, it will cache these scripts\n- Without the scripts in the cache, Claude Code cannot find the MCP server"
    }
  ]
}
```
