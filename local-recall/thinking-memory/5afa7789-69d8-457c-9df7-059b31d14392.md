---
id: 5afa7789-69d8-457c-9df7-059b31d14392
subject: >-
  The search engine doesn't add any additional threshold filtering - it just
  passes the results...
applies_to: global
occurred_at: '2025-12-03T11:56:39.580Z'
content_hash: 58c75adbf678a2e3
---
## Thought

The search engine doesn't add any additional threshold filtering - it just passes the results through. The filtering happens in the hook itself (lines 44-48 in user-prompt-submit.ts).

So the flow is:
1. Vector store returns all results above `similarity: 0` threshold (disabled)
2. Search engine passes through without filtering
3. Hook filters by `config.episodicMinSimilarity` (now 0.5)So scoring with 0.5 threshold:- Score 0.6 → 60% similarity → included- Score 0.4 → 40% similarity → excluded
- Score 0.5 → 50% similarity → included (equal to threshold)The `if (result.score < minSimilarity)` means scores >= minSimilarity are included.

This looks correct. Let me now update the architecture.md to fix the SQLite references.

## Output

The similarity threshold logic is correct:
1. Orama returns scores 0-1 (higher = more similar)
2. The hook at line 45-47 does `if (result.score < minSimilarity) continue` 
3. So scores >= threshold pass through

With 0.5 threshold: 60% similarity passes, 40% fails, 50% passes.

Now let me update the architecture.md to fix the SQLite references:
