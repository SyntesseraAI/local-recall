---
id: b5cd20fb-801c-465e-a9dd-d39790d031d0
subject: >-
  Looking at the SearchEngine and ThinkingSearchEngine, they don't store the
  vector store - they call...
applies_to: global
occurred_at: '2025-12-03T09:32:39.164Z'
content_hash: d656a72282686c43
---
## Thought

Looking at the SearchEngine and ThinkingSearchEngine, they don't store the vector store - they call `getVectorStore()` each time in the search method. Since `getVectorStore()` now creates a new instance each time and that instance uses ephemeral connections, the engines should work correctly.

Actually, looking more closely at `search.ts`:
```typescript
async search(
  query: string,
  options: SearchOptions = {}
): Promise<SearchResult[]> {
  ...
  const vectorStore = getVectorStore({ readonly: this.readonly });
  const results = await vectorStore.search(query, {
    limit,
    scope: options.scope,
  });
  ...
}
```

This creates a new VectorStore instance each time (now that we removed the singleton), and the VectorStore's search method opens a connection, does the search, and closes it. This is correct.

Similarly for ThinkingSearchEngine. The engines don't need changes.

Let me mark those as done and build the project.

## Output

Looking at the search engines - they already call `getVectorStore()` and `getThinkingVectorStore()` per-search which will now create fresh instances with ephemeral connections. No changes needed there.
