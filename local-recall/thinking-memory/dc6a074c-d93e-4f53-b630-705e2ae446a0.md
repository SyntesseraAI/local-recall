---
id: dc6a074c-d93e-4f53-b630-705e2ae446a0
subject: >-
  I see the issue now - many tests are failing because they don't provide
  `occurred_at` in the test...
applies_to: global
occurred_at: '2025-11-29T21:59:41.184Z'
content_hash: 464bc712409aa3cb
---
## Thought

I see the issue now - many tests are failing because they don't provide `occurred_at` in the test data. This is a separate issue from my transcript changes. The tests were already failing before my changes because of the `occurred_at` field requirement.

Also, my transcript parsing changes broke some tests because:
1. The old tests expected the format with `role` field but now I'm looking for `type` field
2. The tests are using the old format

Let me check what's happening and focus on the transcript tests first - those are the ones I changed.

Looking at the failures:
- `should parse valid transcript input` - expects 2 messages but gets 0 (because the test data uses `role` not `type`)
- Other transcript tests also fail

I need to make the parsing backward-compatible to handle both formats. Let me update the code to check for both `role` and `type` fields.

## Output

I see two issues:
1. The transcript tests are failing because I changed to look for `type` field but tests use `role`
2. Many other tests were already failing due to missing `occurred_at` field (pre-existing issue)

Let me make the transcript parsing backward-compatible to support both formats:
