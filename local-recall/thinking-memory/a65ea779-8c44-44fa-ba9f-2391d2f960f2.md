---
id: a65ea779-8c44-44fa-ba9f-2391d2f960f2
subject: >-
  I see the problem now. Looking at the `MemoryManager` class, it has an
  `ensureDir()` method that...
applies_to: global
occurred_at: '2025-11-29T23:50:38.845Z'
content_hash: abdb6ed648c4556d
---
I see the problem now. Looking at the `MemoryManager` class, it has an `ensureDir()` method that creates the `memories` directory, but it does NOT create the `.gitignore` file in the parent `local-recall` directory.

The `IndexManager` has the `ensureGitignore()` method, but it's only called:
1. In `getIndex()` - which may not have been called yet
2. In `ensureDir()` - which is called from `buildIndex()`

But if no index has been built yet (and we see that `index.json` doesn't exist), then the `.gitignore` won't have been created unless `getIndex()` was called.

The issue is that `MemoryManager.createMemory()` creates the `memories` directory, but it doesn't ensure the parent `.gitignore` is created. So when memories are created, the directory structure is set up but the `.gitignore` is not created.

The fix would be to ensure that either:
1. The `MemoryManager` also calls something to ensure the `.gitignore` exists, OR
2. The `IndexManager.ensureGitignore()` is called more proactively, OR
3. There's a shared initialization function that both use

Looking at the architecture, I think the best approach is to have `MemoryManager` also ensure the `.gitignore` exists when it creates the memories directory. This way, the `.gitignore` will be created as soon as any memory operations happen, not just when the index is built.

Let me create a fix for this.
