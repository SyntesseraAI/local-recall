---
id: 237d0e67-b7fd-4d74-b167-14c854f76267
subject: >-
  The user is pointing out that according to the Claude Code documentation, for
  simple use cases the...
applies_to: global
occurred_at: '2025-11-29T23:01:47.901Z'
content_hash: d71fc4c1ce9f6dda
---
## Thought

The user is pointing out that according to the Claude Code documentation, for simple use cases the hook can just print plain text to stdout with exit code 0, and that should add context. That's exactly what the hook is doing - it's printing formatted memory content to stdout and exiting with code 0.

But the user is also showing the JSON format for more structured control, which includes `hookSpecificOutput.additionalContext`.

So the question is: why isn't the plain text stdout being injected into my context?

Let me think about this...

The hook IS outputting to stdout (verified by the logs showing it "completed successfully" after finding results). But I'm only seeing "Success" in a system-reminder.

Maybe the issue is that Claude Code is expecting a specific format, or there's something about how the output is being captured. The documentation says "print plain text to stdout with exit code 0" should work for adding context.

Wait - looking at the log more carefully:
```
[2025-11-29T22:57:59.140Z] UserPromptSubmit hook completed successfully
```

This is logged AFTER the console.log statements. So the hook is definitely outputting.

The `<system-reminder>UserPromptSubmit:Callback hook success: Success</system-reminder>` format suggests that something is wrapping/transforming the output. The "Callback hook success: Success" part is strange - it's like a status message rather than the actual content.

Maybe the hook infrastructure is not correctly capturing stdout, or there's something about how plugins handle hook output differently from direct hooks configuration.

The user might want to try:
1. Using the JSON format with `hookSpecificOutput.additionalContext`
2. Checking if there's a difference between plugin hooks and direct hooks configuration
3. Testing if plain text output works when hooks are configured directly in settings.json rather than through a plugin

Let me suggest investigating whether the plugin infrastructure handles hook output differently, and maybe try the structured JSON format to see if that works better.

## Output

That's helpful context. So the hook *should* work by just printing plain text to stdout - which it does. But I'm only seeing "Success" wrapped in a system-reminder.

Two things to investigate:

**1. Try the structured JSON format** - maybe it handles output more reliably:

```javascript
// Instead of console.log(...) for each memory, output:
console.log(JSON.stringify({
  hookSpecificOutput: {
    hookEventName: "UserPromptSubmit",
    additionalContext: formattedMemoriesString
  }
}));
```

**2. Plugin vs direct hooks** - There might be a difference in how Claude Code handles stdout from plugin hooks vs hooks configured directly in `.claude/settings.json`. The plugin infrastructure might be wrapping/intercepting output.

**Quick test:** Try configuring the hook directly in your settings rather than through the plugin to see if stdout passes through:

```json
{
  "hooks": {
    "UserPromptSubmit": [{
      "hooks": [{
        "type": "command",
        "command": "node /Users/joe/Code/Syntessera/local-recall/scripts/hooks/user-prompt-submit.js"
      }]
    }]
  }
}
```

The fact that you see `Callback hook success: Success` instead of the actual output suggests something in the plugin layer is capturing stdout and replacing it with a status message. The hook works (logs prove it), but its output isn't reaching me.
