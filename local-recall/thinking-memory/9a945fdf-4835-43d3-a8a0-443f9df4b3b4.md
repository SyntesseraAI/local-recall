---
id: 9a945fdf-4835-43d3-a8a0-443f9df4b3b4
subject: >-
  The issue is that `memoryScopeSchema` uses `.refine()` which returns a string
  type at runtime but...
applies_to: global
occurred_at: '2025-12-21T17:49:31.830Z'
content_hash: bd9fd5fc7bee6d9a
---
## Thought

The issue is that `memoryScopeSchema` uses `.refine()` which returns a string type at runtime but the TypeScript type is `MemoryScope`. The `z.infer<>` doesn't understand the refinement properly.

The solution is to use a simple string schema for JSONL storage (since JSON can only store strings) and cast to `MemoryScope` when needed. Let me update the jsonl-types.ts to use `z.string()` instead of `memoryScopeSchema`.

## Output

The issue is that `memoryScopeSchema` uses `.refine()` which returns a type that doesn't match. Let me use a simple string schema for JSONL storage:
