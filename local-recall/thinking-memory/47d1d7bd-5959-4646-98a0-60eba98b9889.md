---
id: 47d1d7bd-5959-4646-98a0-60eba98b9889
subject: >-
  The edit tool is failing with stream errors. This might be a session issue.
  Let me inform the user...
applies_to: global
occurred_at: '2025-11-29T23:57:59.509Z'
content_hash: d3939fa1e1204122
---
## Thought

The edit tool is failing with stream errors. This might be a session issue. Let me inform the user about what needs to be changed instead, or try a different approach.

## Output

I'm having trouble editing the file directly. Let me show you the exact change needed:

In [src/hooks/session-start.ts](src/hooks/session-start.ts), replace lines 79-107 with:

```typescript
    if (memories.length === 0) {
      logger.hooks.info('SessionStart hook completed (no memories)');
      process.exit(0);
    }

    // Build context string for Claude
    const contextParts: string[] = [
      '# Local Recall: Loaded Memories',
      '',
      `Found ${memories.length} relevant memories for this session.`,
      '',
    ];

    for (const memory of memories) {
      contextParts.push(formatMemoryForDisplay(memory));
      contextParts.push('');
      contextParts.push('---');
      contextParts.push('');
    }

    // Add index stats
    const stats = await indexManager.getStats();
    contextParts.push('## Memory Index Status');
    contextParts.push('');
    contextParts.push(`- Total memories: ${stats.memoriesIndexed}`);
    contextParts.push(`- Total keywords: ${stats.keywordsIndexed}`);
    contextParts.push(`- Last indexed: ${stats.builtAt}`);

    const additionalContext = contextParts.join('\n');

    // Output as structured JSON for Claude Code hooks
    const output = {
      hookSpecificOutput: {
        hookEventName: 'SessionStart',
        additionalContext,
      },
    };

    console.log(JSON.stringify(output));
```

The key change is wrapping the output in a JSON structure with `hookSpecificOutput.additionalContext` instead of plain text to stdout. After rebuilding, the memories should appear in my context!
