---
id: 257cefb2-ca2b-4e19-92cf-8bba5c04b474
subject: >-
  The user is encountering a mutex error with sqlite-vec when hooks try to query
  the database....
applies_to: global
occurred_at: '2025-12-03T10:31:37.637Z'
content_hash: 59475ab50f360407
---
## Thought

The user is encountering a mutex error with sqlite-vec when hooks try to query the database. According to the CLAUDE.md, the architecture was designed to avoid this exact problem by having hooks communicate with the MCP daemon via HTTP instead of loading sqlite-vec directly.

Let me look at the current hook implementation to see why this might be happening. The error suggests the hook is still trying to load sqlite-vec directly instead of using the daemon HTTP API.

Let me check the user-prompt-submit hook and related files to understand what's happening.

## Output

Let me investigate the hook implementation to see why sqlite-vec might be loading directly instead of using the HTTP daemon client as intended.
